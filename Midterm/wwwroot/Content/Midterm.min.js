(function(n){"use strict";Date.now||(Date.now=function(){return(new Date).getTime()});Math.trunc||(Math.trunc=function(n){return n<0?Math.ceil(n):Math.floor(n)});Object.setPrototypeOf||(Object.setPrototypeOf=function(n,t){return n.__proto__=t,n});n.WebSharper={Runtime:{Ctor:function(n,t){return n.prototype=t.prototype,n},Class:function(n,t,i){var u=n,f,r,e;if(t){u=new t;for(f in n)u[f]=n[f]}if(r=function(n){if(n)for(var t in n)this[t]=n[t]},r.prototype=u,i)for(e in i)r[e]=i[e];return r},Clone:function(n){var t={};for(var i of Object.getOwnPropertyNames(n))t[i]=n[i];return Object.setPrototypeOf(t,Object.getPrototypeOf(n)),t},NewObject:function(n){for(var i={},t=0;t<n.length;t++)i[n[t][0]]=n[t][1];return i},PrintObject:function(n){var t="{ ",i=!0;for(var r of Object.getOwnPropertyNames(n))i?i=!1:t+=", ",t+=r+" = "+n[r];return t+(i?"}":" }")},DeleteEmptyFields:function(n,t){for(var r,i=0;i<t.length;i++)r=t[i],n[r]===void 0&&delete n[r];return n},GetOptional:function(n){return n===void 0?null:{$:1,$0:n}},SetOptional:function(n,t,i){i?n[t]=i.$0:delete n[t]},SetOrDelete:function(n,t,i){i===void 0?delete n[t]:n[t]=i},Apply:function(n,t,i){return n.apply(t,i)},Bind:function(n){return function(){return n.apply(this,arguments)}},CreateFuncWithArgs:function(n){return function(){return n(Array.prototype.slice.call(arguments))}},CreateFuncWithOnlyThis:function(n){return function(){return n(this)}},CreateFuncWithThis:function(n){return function(){return n(this).apply(null,arguments)}},CreateFuncWithThisArgs:function(n){return function(){return n(this)(Array.prototype.slice.call(arguments))}},CreateFuncWithRest:function(n,t){return function(){return t(Array.prototype.slice.call(arguments,0,n).concat([Array.prototype.slice.call(arguments,n)]))}},CreateFuncWithArgsRest:function(n,t){return function(){return t([Array.prototype.slice.call(arguments,0,n),Array.prototype.slice.call(arguments,n)])}},BindDelegate:function(n,t){var i=n.bind(t);return i.$Func=n,i.$Target=t,i},CreateDelegate:function(n){if(n.length==0)return null;if(n.length==1)return n[0];var t=function(){for(var i,t=0;t<n.length;t++)i=n[t].apply(null,arguments);return i};return t.$Invokes=n,t},CombineDelegates:function(n){for(var t,i=[],r=0;r<n.length;r++)t=n[r],t&&("$Invokes"in t?i=i.concat(t.$Invokes):i.push(t));return WebSharper.Runtime.CreateDelegate(i)},DelegateEqual:function(n,t){var f,e,i,r,u;if(n===t)return!0;if(n==null||t==null||(f=n.$Invokes||[n],e=t.$Invokes||[t],f.length!=e.length))return!1;for(i=0;i<f.length;i++)if(r=f[i],u=e[i],!(r===u||"$Func"in r&&"$Func"in u&&r.$Func===u.$Func&&r.$Target==u.$Target))return!1;return!0},ThisFunc:function(n){return function(){var t=Array.prototype.slice.call(arguments);return t.unshift(this),n.apply(null,t)}},ThisFuncOut:function(n){return function(){var t=Array.prototype.slice.call(arguments);return n.apply(t.shift(),t)}},ParamsFunc:function(n,t){return function(){var i=Array.prototype.slice.call(arguments);return t.apply(null,i.slice(0,n).concat([i.slice(n)]))}},ParamsFuncOut:function(n,t){return function(){var i=Array.prototype.slice.call(arguments);return t.apply(null,i.slice(0,n).concat(i[n]))}},ThisParamsFunc:function(n,t){return function(){var i=Array.prototype.slice.call(arguments);return i.unshift(this),t.apply(null,i.slice(0,n+1).concat([i.slice(n+1)]))}},ThisParamsFuncOut:function(n,t){return function(){var i=Array.prototype.slice.call(arguments);return t.apply(i.shift(),i.slice(0,n).concat(i[n]))}},Curried:function(n,t,i){return i=i||[],function(r){var u=i.concat([r===void 0?null:r]);return t==1?n.apply(null,u):t==2?function(t){return n.apply(null,u.concat([t===void 0?null:t]))}:WebSharper.Runtime.Curried(n,t-1,u)}},Curried2:function(n){return function(t){return function(i){return n(t,i)}}},Curried3:function(n){return function(t){return function(i){return function(r){return n(t,i,r)}}}},UnionByType:function(n,t,i){for(var u,f=typeof t,r=0;r<n.length;r++)if(u=n[r],typeof u=="number"){if(Array.isArray(t)&&(u==0||t.length==u))return{$:r,$0:t}}else if(u==f)return{$:r,$0:t};if(!i)throw new Error("Type not expected for creating Choice value.");},MarkResizable:function(n){return Object.defineProperty(n,"resizable",{enumerable:!1,writable:!1,configurable:!1,value:!0}),n},MarkReadOnly:function(n){return Object.defineProperty(n,"readonly",{enumerable:!1,writable:!1,configurable:!1,value:!0}),n},ScriptBasePath:"./",ScriptPath:function(n,t){return this.ScriptBasePath+(this.ScriptSkipAssemblyDir?"":n+"/")+t},OnLoad:function(n){"load"in this||(this.load=[]);this.load.push(n)},Start:function(){function n(n){for(var t=0;t<n.length;t++)n[t]()}"load"in this&&(n(this.load),this.load=[])}}};n.WebSharper.Runtime.OnLoad(function(){n.WebSharper&&WebSharper.Activator&&WebSharper.Activator.Activate&&WebSharper.Activator.Activate()});n.ignore=function(){};n.id=function(n){return n};n.fst=function(n){return n[0]};n.snd=function(n){return n[1]};n.trd=function(n){return n[2]};n.console||(n.console={count:ignore,dir:ignore,error:ignore,group:ignore,groupEnd:ignore,info:ignore,log:ignore,profile:ignore,profileEnd:ignore,time:ignore,timeEnd:ignore,trace:ignore,warn:ignore})})(self);
/* https://github.com/jonathantneal/closest */
(function(w,p){p=w.Element.prototype
if(!p.matches){p.matches=p.msMatchesSelector||function(s){var m=(this.document||this.ownerDocument).querySelectorAll(s);for(var i=0;m[i]&&m[i]!==e;++i);return!!m[i]}}
if(!p.closest){p.closest=function(s){var e=this;while(e&&e.nodeType==1){if(e.matches(s))return e;e=e.parentNode}return null}}})(self);
(function(){for(var i=0,t=["webkit","moz"],n=0;n<t.length&&!window.requestAnimationFrame;++n)window.requestAnimationFrame=window[t[n]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[t[n]+"CancelAnimationFrame"]||window[t[n]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(n){var t=(new Date).getTime(),r=Math.max(0,16-(t-i)),u=window.setTimeout(function(){n(t+r)},r);return i=t+r,u});window.cancelAnimationFrame||(window.cancelAnimationFrame=function(n){clearTimeout(n)})})();
(function(a){"use strict";var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,_0,_1,_2,_3,_4,_5,_6,_7,_8,_9,_,$,ba,bb,bc,bd,be,bf,bg,bh,bi,bj,bk,bl,bm,bn,bo,bp,bq,br,bs,bt,bu,bv,bw,bx,by,bz,bA,bB,bC,bD,bE,bF,bG,bH,bI,bJ,bK,bL,bM,bN,bO,bP,bQ,bR,bS,bT,bU,bV,bW,bX,bY,bZ,b0,b1,b2,b3,b4,b5,b6,b7,b8,b9;b=a.Midterm=a.Midterm||{};c=b.Client=b.Client||{};d=a.WebSharper=a.WebSharper||{};e=d.Obj=d.Obj||{};f=d.UI=d.UI||{};g=f.Var$1=f.Var$1||{};h=d.Operators=d.Operators||{};i=f.Templating=f.Templating||{};j=i.Runtime=i.Runtime||{};k=j.Server=j.Server||{};l=k.TemplateInstance=k.TemplateInstance||{};m=d.Arrays=d.Arrays||{};n=k.ProviderBuilder=k.ProviderBuilder||{};o=f.ListModel=f.ListModel||{};p=f.TemplateHole=f.TemplateHole||{};q=d.Unchecked=d.Unchecked||{};r=a.Midterm_Templates=a.Midterm_Templates||{};s=k.Handler=k.Handler||{};t=f.Var=f.Var||{};u=f.ConcreteVar=f.ConcreteVar||{};v=f.Snap=f.Snap||{};w=f.TemplateHoleModule=f.TemplateHoleModule||{};x=w.VarStr=w.VarStr||{};y=w.Elt=w.Elt||{};z=a.System=a.System||{};A=z.Guid=z.Guid||{};B=a.StartupCode$Midterm$Client=a.StartupCode$Midterm$Client||{};C=w.Text=w.Text||{};D=w.EventQ=w.EventQ||{};E=d.Seq=d.Seq||{};F=d.JavaScript=d.JavaScript||{};G=F.Pervasives=F.Pervasives||{};H=f.Client=f.Client||{};I=H.Templates=H.Templates||{};J=f.Doc=f.Doc||{};K=f.Abbrev=f.Abbrev||{};L=K.Fresh=K.Fresh||{};M=d.Collections=d.Collections||{};N=M.Dictionary=M.Dictionary||{};O=a.EventTarget;P=a.Node;Q=f.View=f.View||{};R=a.Object;S=M.HashSet=M.HashSet||{};T=k.TemplateInitializer=k.TemplateInitializer||{};U=w.VarFloatUnchecked=w.VarFloatUnchecked||{};V=w.VarBool=w.VarBool||{};W=w.VarDateTime=w.VarDateTime||{};X=w.VarFile=w.VarFile||{};Y=F.JS=F.JS||{};Z=w.VarDomElement=w.VarDomElement||{};_0=d.Numeric=d.Numeric||{};_1=M.DictionaryUtil=M.DictionaryUtil||{};_2=d.Enumerator=d.Enumerator||{};_3=_2.T=_2.T||{};_4=a.WindowOrWorkerGlobalScope;_5=a.StartupCode$WebSharper_UI$Templates=a.StartupCode$WebSharper_UI$Templates||{};_6=f.Docs=f.Docs||{};_7=a.StartupCode$WebSharper_UI$Abbrev=a.StartupCode$WebSharper_UI$Abbrev||{};_8=f.DocElemNode=f.DocElemNode||{};_9=a.CharacterData;_=f.Storage=f.Storage||{};$=a.Blob;ba=f.Elt=f.Elt||{};bb=a.Element;bc=I.Prepare=I.Prepare||{};bd=d.Slice=d.Slice||{};be=f.DomUtility=f.DomUtility||{};bf=M.KeyCollection=M.KeyCollection||{};bg=f.An=f.An||{};bh=H.Settings=H.Settings||{};bi=K.Mailbox=K.Mailbox||{};bj=H.Attrs=H.Attrs||{};bk=bj.Dyn=bj.Dyn||{};bl=f.Array=f.Array||{};bm=_.ArrayStorage=_.ArrayStorage||{};bn=f.Attrs=f.Attrs||{};bo=w.Attribute=w.Attribute||{};bp=w.Event=w.Event||{};bq=f.AttrModule=f.AttrModule||{};br=f.AttrProxy=f.AttrProxy||{};bs=w.AfterRender=w.AfterRender||{};bt=w.AfterRenderQ=w.AfterRenderQ||{};bu=d.List=d.List||{};bv=bu.T=bu.T||{};bw=d.Strings=d.Strings||{};bx=f.Updates=f.Updates||{};by=M.ValueCollection=M.ValueCollection||{};bz=H.Docs=H.Docs||{};bA=bz.RunState=bz.RunState||{};bB=bz.NodeSet=bz.NodeSet||{};bC=d.Concurrency=d.Concurrency||{};bD=f.Anims=f.Anims||{};bE=a.StartupCode$WebSharper_UI$Doc_Proxy=a.StartupCode$WebSharper_UI$Doc_Proxy||{};bF=M.HashSetUtil=M.HashSetUtil||{};bG=a.StartupCode$WebSharper_UI$DomUtility=a.StartupCode$WebSharper_UI$DomUtility||{};bH=a.StartupCode$WebSharper_UI$Animation=a.StartupCode$WebSharper_UI$Animation||{};bI=f.AppendList=f.AppendList||{};bJ=f.DynamicAttrNode=f.DynamicAttrNode||{};bK=a.Error;bL=d.KeyNotFoundException=d.KeyNotFoundException||{};bM=a.StartupCode$WebSharper_UI$Attr_Client=a.StartupCode$WebSharper_UI$Attr_Client||{};bN=bC.Scheduler=bC.Scheduler||{};bO=f.Easing=f.Easing||{};bP=bC.AsyncBody=bC.AsyncBody||{};bQ=a.StartupCode$WebSharper_Main$Concurrency=a.StartupCode$WebSharper_Main$Concurrency||{};bR=bC.CT=bC.CT||{};bS=K.HashSet=K.HashSet||{};bT=f.BindVar=f.BindVar||{};bU=f.String=f.String||{};bV=f.CheckedInput=f.CheckedInput||{};bW=d.CancellationTokenSource=d.CancellationTokenSource||{};bX=bz.DomNodes=bz.DomNodes||{};bY=d.Queue=d.Queue||{};bZ=d.Char=d.Char||{};b0=d.DateUtil=d.DateUtil||{};b1=d.OperationCanceledException=d.OperationCanceledException||{};b2=d.Lazy=d.Lazy||{};b3=a.StartupCode$WebSharper_UI$AppendList=a.StartupCode$WebSharper_UI$AppendList||{};b4=d.LazyExtensionsProxy=d.LazyExtensionsProxy||{};b5=b4.LazyRecord=b4.LazyRecord||{};b6=d&&d.Runtime;b7=a.console;b8=a.Math;b9=a.Date;c.Main=function(){var b_,b$,ca,cb,cc,cd,ce,cf,cg,ch;b_=g.Create$1("");b$=(ca=(cb=(cc=(cd=(ce=J.Convert(function(ci){var cj,ck,cl,cm;return(cj=(ck=new n.New$1(),(ck.h.push(new C.New("name",ci)),ck)),(cl=s.CompleteHoles(cj.k,cj.h,[]),(cm=new l.New(cl[1],r.listitem(cl[0])),cj.i=cm,cm))).get_Doc();},c.People().v),(cf=new n.New$1(),(cf.h.push(new y.New("listcontainer",ce)),cf))),(cd.h.push(new x.New("name",b_)),cd)),(cc.h.push(s.EventQ2(cc.k,"add",function(){return cc.i;},function(){c.People().Append(b_.Get());b_.Set("");})),cc)),(cb.h.push(s.EventQ2(cb.k,"clear",function(){return cb.i;},function(){c.People().Clear();})),cb)),(cg=s.CompleteHoles(ca.k,ca.h,[["name",0,null]]),(ch=new l.New(cg[1],r.main(cg[0])),ca.i=ch,ch))).get_Doc();I.LoadLocalTemplates("");J.RunById("main",b$);};c.People=function(){B.$cctor();return B.People;};e=d.Obj=b6.Class({Equals:function(b_){return this===b_;},GetHashCode:function(){return -1;}},null,e);e.New=b6.Ctor(function(){},e);g=f.Var$1=b6.Class({},e,g);g.Create$1=function(b_){return new u.New(false,v.New({$:2,$0:b_,$1:[]}),b_);};h.FailWith=function(b_){throw new bK(b_);};h.KeyValue=function(b_){return[b_.K,b_.V];};h.range=function(b_,b$){var ca;ca=1+b$-b_;return ca<=0?[]:E.init(ca,function(cb){return cb+b_;});};l=k.TemplateInstance=b6.Class({get_Doc:function(){return this.doc;},SetAnchorRoot:function(b_){this.anchorRoot=b_;}},e,l);l.New=b6.Ctor(function(b_,b$){e.New.call(this);this.doc=b$;this.allVars=b_.$==0?b_.$0:h.FailWith("Should not happen");this.anchorRoot=null;},l);m.get=function(b_,b$){m.checkBounds(b_,b$);return b_[b$];};m.length=function(b_){return b_.dims===2?b_.length*b_.length:b_.length;};m.checkBounds=function(b_,b$){if(b$<0||b$>=b_.length)h.FailWith("Index was outside the bounds of the array.");};m.set=function(b_,b$,ca){m.checkBounds(b_,b$);b_[b$]=ca;};n=k.ProviderBuilder=b6.Class({},e,n);n.New$1=b6.Ctor(function(){var b_;e.New.call(this);this.i=null;this.k=(b_=A.NewGuid(),a.String(b_));this.h=b6.MarkResizable([]);b6.SetOptional(this,"s",null);},n);o=f.ListModel=b6.Class({Clear:function(){this["var"].Set(this.storage.SSet([]));this.ObsoleteAll();},Append:function(b_){var b$,ca,cb,cc;b$=this;ca=this["var"].Get();cb=this.key(b_);cc=m.tryFindIndex(function(cd){return q.Equals(b$.key(cd),cb);},ca);if(cc!=null&&cc.$==1)this["var"].Set(this.storage.SSetAt(cc.$0,b_,ca));else this["var"].Set(this.storage.SAppend(b_,ca));this.ObsoleteKey(cb);},ObsoleteAll:function(){E.iter(function(b_){v.Obsolete(b_.V);},this.it);this.it.Clear();},ObsoleteKey:function(b_){var b$,ca;b$=(ca=null,[this.it.TryGetValue(b_,{get:function(){return ca;},set:function(cb){ca=cb;}}),ca]);if(b$[0]){v.Obsolete(b$[1]);this.it.RemoveKey(b_);}},GetEnumerator:function(){return _2.Get(this["var"].Get());},GetEnumerator0:function(){return _2.Get0(this["var"].Get());}},e,o);o.New=b6.Ctor(function(b_,b$){o.New$3.call(this,b_,g.Create$1(m.ofSeq(E.distinctBy(b_,b$.SInit()))),b$);},o);o.New$3=b6.Ctor(function(b_,b$,ca){e.New.call(this);this.key=b_;this["var"]=b$;this.storage=ca;this.v=Q.Map(function(cb){return cb.slice();},this["var"].get_View());this.it=new N.New$5();},o);p=f.TemplateHole=b6.Class({ForTextView:function(){b7.warn("Content hole filled with attribute data",this.get_Name());return null;},AddAttribute:function(b_,b$){b7.warn("Var hole filled with non-Var data",this.get_Name());},get_AsChoiceView:function(){b7.warn("Attribute value hole filled with non-text data",this.get_Name());return{$:0,$0:""};}},e,p);p.New=b6.Ctor(function(){e.New.call(this);},p);q.Equals=function(b_,b$){var ca,cb,cc,cd;if(b_===b$)return true;else{ca=typeof b_;if(ca=="object"){if(b_===null||b_===void 0||b$===null||b$===void 0||!q.Equals(typeof b$,"object"))return false;else if("Equals"in b_)return b_.Equals(b$);else if("Equals"in b$)return false;else if(b_ instanceof a.Array&&b$ instanceof a.Array)return q.arrayEquals(b_,b$);else if(b_ instanceof a.Date&&b$ instanceof a.Date)return q.dateEquals(b_,b$);else{cb=[true];for(var ce in b_)if(function(cf){cb[0]=!b_.hasOwnProperty(cf)||b$.hasOwnProperty(cf)&&q.Equals(b_[cf],b$[cf]);return!cb[0];}(ce))break;if(cb[0]){for(var cf in b$)if(function(cg){cb[0]=!b$.hasOwnProperty(cg)||b_.hasOwnProperty(cg);return!cb[0];}(cf))break;}return cb[0];}}else return ca=="function"&&("$Func"in b_?b_.$Func===b$.$Func&&b_.$Target===b$.$Target:"$Invokes"in b_&&"$Invokes"in b$&&q.arrayEquals(b_.$Invokes,b$.$Invokes));}};q.arrayEquals=function(b_,b$){var ca,cb;if(m.length(b_)===m.length(b$)){ca=true;cb=0;while(ca&&cb<m.length(b_)){!q.Equals(m.get(b_,cb),m.get(b$,cb))?ca=false:void 0;cb=cb+1;}return ca;}else return false;};q.dateEquals=function(b_,b$){return b_.getTime()===b$.getTime();};q.Hash=function(b_){var b$;b$=typeof b_;return b$=="function"?0:b$=="boolean"?b_?1:0:b$=="number"?b_:b$=="string"?q.hashString(b_):b$=="object"?b_==null?0:b_ instanceof a.Array?q.hashArray(b_):q.hashObject(b_):0;};q.hashString=function(b_){var b$,ca,cb;if(b_===null)return 0;else{b$=5381;for(ca=0,cb=b_.length-1;ca<=cb;ca++)b$=q.hashMix(b$,b_[ca].charCodeAt());return b$;}};q.hashArray=function(b_){var b$,ca,cb;b$=-34948909;for(ca=0,cb=m.length(b_)-1;ca<=cb;ca++)b$=q.hashMix(b$,q.Hash(m.get(b_,ca)));return b$;};q.hashObject=function(b_){var b$,ca;if("GetHashCode"in b_)return b_.GetHashCode();else{b$=[0];for(var cb in b_)if(function(cc){b$[0]=q.hashMix(q.hashMix(b$[0],q.hashString(cc)),q.Hash(b_[cc]));return false;}(cb))break;return b$[0];}};q.hashMix=function(b_,b$){return(b_<<5)+b_+b$;};q.Compare=function(b_,b$){var ca,cb,cc,cd,ce,cf;if(b_===b$)return 0;else{cb=typeof b_;switch(cb=="function"?1:cb=="boolean"?2:cb=="number"?2:cb=="string"?2:cb=="object"?3:0){case 0:return typeof b$=="undefined"?0:-1;case 1:return h.FailWith("Cannot compare function values.");case 2:return b_<b$?-1:1;case 3:if(b_===null)cc=-1;else if(b$===null)cc=1;else if("CompareTo"in b_)cc=b_.CompareTo(b$);else if("CompareTo0"in b_)cc=b_.CompareTo0(b$);else if(b_ instanceof a.Array&&b$ instanceof a.Array)cc=q.compareArrays(b_,b$);else if(b_ instanceof a.Date&&b$ instanceof a.Date)cc=q.compareDates(b_,b$);else{cd=[0];for(var cg in b_)if(function(ch){return!b_.hasOwnProperty(ch)?false:!b$.hasOwnProperty(ch)?(cd[0]=1,true):(cd[0]=q.Compare(b_[ch],b$[ch]),cd[0]!==0);}(cg))break;if(cd[0]===0){for(var ch in b$)if(function(ci){return!b$.hasOwnProperty(ci)?false:!b_.hasOwnProperty(ci)&&(cd[0]=-1,true);}(ch))break;}cc=cd[0];}return cc;}}};q.compareArrays=function(b_,b$){var ca,cb;if(m.length(b_)<m.length(b$))return -1;else if(m.length(b_)>m.length(b$))return 1;else{ca=0;cb=0;while(ca===0&&cb<m.length(b_)){ca=q.Compare(m.get(b_,cb),m.get(b$,cb));cb=cb+1;}return ca;}};q.compareDates=function(b_,b$){return q.Compare(b_.getTime(),b$.getTime());};r.listitem=function(b_){I.LoadLocalTemplates("index");return b_?I.NamedTemplate("index",{$:1,$0:"listitem"},b_):void 0;};r.main=function(b_){I.LoadLocalTemplates("index");return b_?I.NamedTemplate("index",{$:1,$0:"main"},b_):void 0;};s.EventQ2=function(b_,b$,ca,cb){return new D.New(b$,function(cc){return function(cd){var ce;ce=ca();ce.SetAnchorRoot(cc);return cb({Vars:ce,Anchors:ce,Target:cc,Event:cd});};});};s.CompleteHoles=function(b_,b$,ca){var cc,cd,ce,cf,cg;function cb(ch,ci,cj){var ck;return cd.Contains(ch)?null:(ck=q.Equals(ci,0)?T.GetOrAddHoleFor(b_,ch,function(){return new x.New(ch,g.Create$1(""));}):q.Equals(ci,1)?T.GetOrAddHoleFor(b_,ch,function(){return new U.New(ch,g.Create$1(0));}):q.Equals(ci,2)?T.GetOrAddHoleFor(b_,ch,function(){return new V.New(ch,g.Create$1(false));}):q.Equals(ci,3)?T.GetOrAddHoleFor(b_,ch,function(){return new W.New(ch,g.Create$1(-8640000000000000));}):q.Equals(ci,4)?T.GetOrAddHoleFor(b_,ch,function(){return new X.New(ch,g.Create$1([]));}):q.Equals(ci,5)?T.GetOrAddHoleFor(b_,ch,function(){var cl;cl=self.document.querySelector("[ws-dom="+ch+"]");cl.removeAttribute("ws-dom");return new Z.New(ch,g.Create$1({$:1,$0:cl}));}):h.FailWith("Invalid value type"),(cc.set_Item(ch,ck),{$:1,$0:ck}));}cc=new N.New$5();cd=new S.New$3();ce=_2.Get(b$);try{while(ce.MoveNext()){cf=ce.Current();cg=cf.get_Name();cd.SAdd(cg);cc.set_Item(cg,cf);}}finally{if(typeof ce=="object"&&"Dispose"in ce)ce.Dispose();}return[E.append(b$,m.choose(function(ch){return cb(ch[0],ch[1],ch[2]);},ca)),{$:0,$0:cc}];};t=f.Var=b6.Class({},e,t);t.New=b6.Ctor(function(){e.New.call(this);},t);u=f.ConcreteVar=b6.Class({Get:function(){return this.current;},Set:function(b_){if(this.isConst)(function(b$){return b$("WebSharper.UI: invalid attempt to change value of a Var after calling SetFinal");}(function(b$){b7.log(b$);}));else{v.Obsolete(this.snap);this.current=b_;this.snap=v.New({$:2,$0:b_,$1:[]});}},SetFinal:function(b_){if(this.isConst)(function(b$){return b$("WebSharper.UI: invalid attempt to change value of a Var after calling SetFinal");}(function(b$){b7.log(b$);}));else{v.Obsolete(this.snap);this.isConst=true;this.current=b_;this.snap=v.New({$:0,$0:b_});}},get_View:function(){return this.view;},UpdateMaybe:function(b_){var b$;b$=b_(this.Get());if(b$!=null&&b$.$==1)this.Set(b$.$0);}},t,u);u.New=b6.Ctor(function(b_,b$,ca){var cb;cb=this;t.New.call(this);this.isConst=b_;this.current=ca;this.snap=b$;this.view=function(){return cb.snap;};this.id=L.Int();},u);v.Map=function(b_,b$){var ca,cb;ca=b$.s;return ca!=null&&ca.$==0?v.New({$:0,$0:b_(ca.$0)}):(cb=v.New({$:3,$0:[],$1:[]}),(v.When(b$,function(cc){v.MarkDone(cb,b$,b_(cc));},cb),cb));};v.WhenRun=function(b_,b$,ca){var cb;cb=b_.s;if(cb==null)ca();else cb!=null&&cb.$==2?(cb.$1.push(ca),b$(cb.$0)):cb!=null&&cb.$==3?(cb.$0.push(b$),cb.$1.push(ca)):b$(cb.$0);};v.WhenObsoleteRun=function(b_,b$){var ca;ca=b_.s;if(ca==null)b$();else ca!=null&&ca.$==2?ca.$1.push(b$):ca!=null&&ca.$==3?ca.$1.push(b$):void 0;};v.When=function(b_,b$,ca){var cb;cb=b_.s;if(cb==null)v.Obsolete(ca);else cb!=null&&cb.$==2?(v.EnqueueSafe(cb.$1,ca),b$(cb.$0)):cb!=null&&cb.$==3?(cb.$0.push(b$),v.EnqueueSafe(cb.$1,ca)):b$(cb.$0);};v.MarkDone=function(b_,b$,ca){var cb;if(cb=b$.s,cb!=null&&cb.$==0)v.MarkForever(b_,ca);else v.MarkReady(b_,ca);};v.Map3=function(b_,b$,ca,cb){var cc,cd,ce,cf;function cg(ch){var ci,cj,ck,cl;if(!(ci=cf.s,ci!=null&&ci.$==0||ci!=null&&ci.$==2)){cj=v.ValueAndForever(b$);ck=v.ValueAndForever(ca);cl=v.ValueAndForever(cb);if(cj!=null&&cj.$==1)ck!=null&&ck.$==1?cl!=null&&cl.$==1?cj.$0[1]&&ck.$0[1]&&cl.$0[1]?v.MarkForever(cf,b_(cj.$0[0],ck.$0[0],cl.$0[0])):v.MarkReady(cf,b_(cj.$0[0],ck.$0[0],cl.$0[0])):void 0:void 0;}}cc=b$.s;cd=ca.s;ce=cb.s;return cc!=null&&cc.$==0?cd!=null&&cd.$==0?ce!=null&&ce.$==0?v.New({$:0,$0:b_(cc.$0,cd.$0,ce.$0)}):v.Map3Opt1(b_,cc.$0,cd.$0,cb):ce!=null&&ce.$==0?v.Map3Opt2(b_,cc.$0,ce.$0,ca):v.Map3Opt3(b_,cc.$0,ca,cb):cd!=null&&cd.$==0?ce!=null&&ce.$==0?v.Map3Opt4(b_,cd.$0,ce.$0,b$):v.Map3Opt5(b_,cd.$0,b$,cb):ce!=null&&ce.$==0?v.Map3Opt6(b_,ce.$0,b$,ca):(cf=v.New({$:3,$0:[],$1:[]}),(v.When(b$,cg,cf),v.When(ca,cg,cf),v.When(cb,cg,cf),cf));};v.Sequence=function(b_){var b$,ca,cb;function cc(cd){var ce;if(cb[0]===0){ce=m.map(function(cf){var cg;cg=cf.s;return cg!=null&&cg.$==0?cg.$0:cg!=null&&cg.$==2?cg.$0:h.FailWith("value not found by View.Sequence");},b$);if(m.forall(function(cf){var cg;cg=cf.s;return cg!=null&&cg.$==0;},b$))v.MarkForever(ca,ce);else v.MarkReady(ca,ce);}else cb[0]=cb[0]-1;}b$=m.ofSeq(b_);return b$.length==0?v.New({$:0,$0:[]}):(ca=v.New({$:3,$0:[],$1:[]}),(cb=[m.length(b$)-1],(m.iter(function(cd){v.When(cd,cc,ca);},b$),ca)));};v.Map2=function(b_,b$,ca){var cb,cc,cd;function ce(cf){var cg,ch,ci;if(!(cg=cd.s,cg!=null&&cg.$==0||cg!=null&&cg.$==2)){ch=v.ValueAndForever(b$);ci=v.ValueAndForever(ca);if(ch!=null&&ch.$==1)ci!=null&&ci.$==1?ch.$0[1]&&ci.$0[1]?v.MarkForever(cd,b_(ch.$0[0],ci.$0[0])):v.MarkReady(cd,b_(ch.$0[0],ci.$0[0])):void 0;}}cb=b$.s;cc=ca.s;return cb!=null&&cb.$==0?cc!=null&&cc.$==0?v.New({$:0,$0:b_(cb.$0,cc.$0)}):v.Map2Opt1(b_,cb.$0,ca):cc!=null&&cc.$==0?v.Map2Opt2(b_,cc.$0,b$):(cd=v.New({$:3,$0:[],$1:[]}),(v.When(b$,ce,cd),v.When(ca,ce,cd),cd));};v.Map2Unit=function(b_,b$){var ca,cb,cc;function cd(){var ce,cf,cg;if(!(ce=cc.s,ce!=null&&ce.$==0||ce!=null&&ce.$==2)){cf=v.ValueAndForever(b_);cg=v.ValueAndForever(b$);if(cf!=null&&cf.$==1)cg!=null&&cg.$==1?cf.$0[1]&&cg.$0[1]?v.MarkForever(cc,null):v.MarkReady(cc,null):void 0;}}ca=b_.s;cb=b$.s;return ca!=null&&ca.$==0?cb!=null&&cb.$==0?v.New({$:0,$0:null}):b$:cb!=null&&cb.$==0?b_:(cc=v.New({$:3,$0:[],$1:[]}),(v.When(b_,cd,cc),v.When(b$,cd,cc),cc));};v.Copy=function(b_){var b$,ca,cb;b$=b_.s;return b$==null?b_:b$!=null&&b$.$==2?(ca=v.New({$:2,$0:b$.$0,$1:[]}),(v.WhenObsolete(b_,ca),ca)):b$!=null&&b$.$==3?(cb=v.New({$:3,$0:[],$1:[]}),(v.When(b_,function(cc){v.MarkDone(cb,b_,cc);},cb),cb)):b_;};v.EnqueueSafe=function(b_,b$){var ca,cb,cc,cd;b_.push(b$);if(b_.length%20===0){ca=b_.slice(0);bY.Clear(b_);for(cb=0,cc=m.length(ca)-1;cb<=cc;cb++){cd=m.get(ca,cb);if(typeof cd=="object")(function(ce){if(ce.s)b_.push(ce);}(cd));else(function(ce){b_.push(ce);}(cd));}}else void 0;};v.MarkForever=function(b_,b$){var ca,cb,cc,cd;ca=b_.s;if(ca!=null&&ca.$==3){b_.s={$:0,$0:b$};cb=ca.$0;for(cc=0,cd=m.length(cb)-1;cc<=cd;cc++)(m.get(cb,cc))(b$);}else void 0;};v.MarkReady=function(b_,b$){var ca,cb,cc,cd;ca=b_.s;if(ca!=null&&ca.$==3){b_.s={$:2,$0:b$,$1:ca.$1};cb=ca.$0;for(cc=0,cd=m.length(cb)-1;cc<=cd;cc++)(m.get(cb,cc))(b$);}else void 0;};v.Join=function(b_){var b$;b$=v.New({$:3,$0:[],$1:[]});v.When(b_,function(ca){var cb;cb=ca();v.When(cb,function(cc){var cd,ce;if((cd=cb.s,cd!=null&&cd.$==0)&&(ce=b_.s,ce!=null&&ce.$==0))v.MarkForever(b$,cc);else v.MarkReady(b$,cc);},b$);},b$);return b$;};v.Map3Opt1=function(b_,b$,ca,cb){return v.Map(function(cc){return b_(b$,ca,cc);},cb);};v.Map3Opt2=function(b_,b$,ca,cb){return v.Map(function(cc){return b_(b$,cc,ca);},cb);};v.Map3Opt3=function(b_,b$,ca,cb){return v.Map2(function(cc,cd){return b_(b$,cc,cd);},ca,cb);};v.Map3Opt4=function(b_,b$,ca,cb){return v.Map(function(cc){return b_(cc,b$,ca);},cb);};v.Map3Opt5=function(b_,b$,ca,cb){return v.Map2(function(cc,cd){return b_(cc,b$,cd);},ca,cb);};v.Map3Opt6=function(b_,b$,ca,cb){return v.Map2(function(cc,cd){return b_(cc,cd,b$);},ca,cb);};v.ValueAndForever=function(b_){var b$;b$=b_.s;return b$!=null&&b$.$==0?{$:1,$0:[b$.$0,true]}:b$!=null&&b$.$==2?{$:1,$0:[b$.$0,false]}:null;};v.Map2Opt1=function(b_,b$,ca){return v.Map(function(cb){return b_(b$,cb);},ca);};v.Map2Opt2=function(b_,b$,ca){return v.Map(function(cb){return b_(cb,b$);},ca);};v.WhenObsolete=function(b_,b$){var ca;ca=b_.s;if(ca==null)v.Obsolete(b$);else ca!=null&&ca.$==2?v.EnqueueSafe(ca.$1,b$):ca!=null&&ca.$==3?v.EnqueueSafe(ca.$1,b$):void 0;};x=w.VarStr=b6.Class({get_Name:function(){return this.name;},ForTextView:function(){return{$:1,$0:this.fillWith.get_View()};},AddAttribute:function(b_,b$){(b_(b$))(bq.Value(this.fillWith));},get_AsChoiceView:function(){return{$:1,$0:Q.Map(a.String,this.fillWith.get_View())};}},p,x);x.New=b6.Ctor(function(b_,b$){p.New.call(this);this.name=b_;this.fillWith=b$;},x);y=w.Elt=b6.Class({get_Name:function(){return this.name;},get_Value:function(){return this.fillWith;}},p,y);y.New=b6.Ctor(function(b_,b$){p.New.call(this);this.name=b_;this.fillWith=b$;},y);A.NewGuid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(new a.RegExp("[xy]","g"),function(b_){var b$,ca;b$=b8.random()*16|0;ca=b_=="x"?b$:b$&3|8;return ca.toString(16);});};B.$cctor=function(){B.$cctor=a.ignore;B.People=o.FromSeq(["RUNNING","READING"]);};C=w.Text=b6.Class({get_Name:function(){return this.name;},get_Value:function(){return this.fillWith;},get_AsChoiceView:function(){return{$:0,$0:this.fillWith};}},p,C);C.New=b6.Ctor(function(b_,b$){p.New.call(this);this.name=b_;this.fillWith=b$;},C);D=w.EventQ=b6.Class({get_Name:function(){return this.name;},get_Value:function(){return this.fillWith;}},p,D);D.New=b6.Ctor(function(b_,b$){p.New.call(this);this.name=b_;this.fillWith=b$;},D);E.append=function(b_,b$){return{GetEnumerator:function(){var ca,cb;ca=_2.Get(b_);cb=[true];return new _3.New(ca,null,function(cc){var cd;return cc.s.MoveNext()?(cc.c=cc.s.Current(),true):(cd=cc.s,!q.Equals(cd,null)?cd.Dispose():void 0,cc.s=null,cb[0]&&(cb[0]=false,cc.s=_2.Get(b$),cc.s.MoveNext()?(cc.c=cc.s.Current(),true):(cc.s.Dispose(),cc.s=null,false)));},function(cc){var cd;cd=cc.s;if(!q.Equals(cd,null))cd.Dispose();});}};};E.iter=function(b_,b$){var ca;ca=_2.Get(b$);try{while(ca.MoveNext())b_(ca.Current());}finally{if(typeof ca=="object"&&"Dispose"in ca)ca.Dispose();}};E.head=function(b_){var b$;b$=_2.Get(b_);try{return b$.MoveNext()?b$.Current():E.insufficient();}finally{if(typeof b$=="object"&&"Dispose"in b$)b$.Dispose();}};E.fold=function(b_,b$,ca){var cb,cc;cb=b$;cc=_2.Get(ca);try{while(cc.MoveNext())cb=b_(cb,cc.Current());return cb;}finally{if(typeof cc=="object"&&"Dispose"in cc)cc.Dispose();}};E.distinctBy=function(b_,b$){return{GetEnumerator:function(){var ca,cb;ca=_2.Get(b$);cb=new S.New$3();return new _3.New(null,null,function(cc){var cd,ce;if(ca.MoveNext()){cd=ca.Current();ce=cb.SAdd(b_(cd));while(!ce&&ca.MoveNext()){cd=ca.Current();ce=cb.SAdd(b_(cd));}return ce&&(cc.c=cd,true);}else return false;},function(){ca.Dispose();});}};};E.map=function(b_,b$){return{GetEnumerator:function(){var ca;ca=_2.Get(b$);return new _3.New(null,null,function(cb){return ca.MoveNext()&&(cb.c=b_(ca.Current()),true);},function(){ca.Dispose();});}};};E.delay=function(b_){return{GetEnumerator:function(){return _2.Get(b_());}};};E.max=function(b_){var b$,ca,cb;b$=_2.Get(b_);try{if(!b$.MoveNext())E.seqEmpty();ca=b$.Current();while(b$.MoveNext()){cb=b$.Current();if(q.Compare(cb,ca)===1)ca=cb;}return ca;}finally{if(typeof b$=="object"&&"Dispose"in b$)b$.Dispose();}};E.init=function(b_,b$){return E.take(b_,E.initInfinite(b$));};E.seqEmpty=function(){return h.FailWith("The input sequence was empty.");};E.forall=function(b_,b$){return!E.exists(function(ca){return!b_(ca);},b$);};E.take=function(b_,b$){b_<0?E.nonNegative():void 0;return{GetEnumerator:function(){var ca;ca=[_2.Get(b$)];return new _3.New(0,null,function(cb){var cc;cb.s=cb.s+1;return cb.s>b_?false:(cc=ca[0],q.Equals(cc,null)?E.insufficient():cc.MoveNext()?(cb.c=cc.Current(),cb.s===b_?(cc.Dispose(),ca[0]=null):void 0,true):(cc.Dispose(),ca[0]=null,E.insufficient()));},function(){var cb;cb=ca[0];if(!q.Equals(cb,null))cb.Dispose();});}};};E.initInfinite=function(b_){return{GetEnumerator:function(){return new _3.New(0,null,function(b$){b$.c=b_(b$.s);b$.s=b$.s+1;return true;},void 0);}};};E.exists=function(b_,b$){var ca,cb;ca=_2.Get(b$);try{cb=false;while(!cb&&ca.MoveNext())cb=b_(ca.Current());return cb;}finally{if(typeof ca=="object"&&"Dispose"in ca)ca.Dispose();}};G.NewFromSeq=function(b_){var b$,ca,cb;b$={};ca=_2.Get(b_);try{while(ca.MoveNext()){cb=ca.Current();b$[cb[0]]=cb[1];}}finally{if(typeof ca=="object"&&"Dispose"in ca)ca.Dispose();}return b$;};I.LoadLocalTemplates=function(b_){!I.LocalTemplatesLoaded()?(I.set_LocalTemplatesLoaded(true),I.LoadNestedTemplates(self.document.body,"")):void 0;I.LoadedTemplates().set_Item(b_,I.LoadedTemplateFile(""));};I.NamedTemplate=function(b_,b$,ca){var cb,cc;cb=(cc=null,[I.LoadedTemplateFile(b_).TryGetValue(b$==null?"":b$.$0,{get:function(){return cc;},set:function(cd){cc=cd;}}),cc]);return cb[0]?I.ChildrenTemplate(cb[1].cloneNode(true),ca):(b7.warn("Local template doesn't exist",b$),J.get_Empty());};I.LocalTemplatesLoaded=function(){_5.$cctor();return _5.LocalTemplatesLoaded;};I.set_LocalTemplatesLoaded=function(b_){_5.$cctor();_5.LocalTemplatesLoaded=b_;};I.LoadNestedTemplates=function(b_,b$){var cb,cc,cd,ce,cf,cg,ch,ci,cj,ck,cl,cm,cn,co,cp,cq,cr,cs,ct,cu,cv;function ca(cw){var cx,cy;if(!cb.ContainsKey(cw)){cx=(cy=null,[cc.TryGetValue(cw,{get:function(){return cy;},set:function(cz){cy=cz;}}),cy]);if(cx[0]){cv.SAdd(cw);cc.RemoveKey(cw);I.PrepareTemplateStrict(b$,{$:1,$0:cw},cx[1],{$:1,$0:ca});}else b7.warn(cv.Contains(cw)?"Encountered loop when instantiating "+cw:"Local template does not exist: "+cw);}}cb=I.LoadedTemplateFile(b$);cc=new N.New$5();cd=b_.querySelectorAll("[ws-template]");for(ce=0,cf=cd.length-1;ce<=cf;ce++){cg=cd[ce];ch=cg.getAttribute("ws-template").toLowerCase();cg.removeAttribute("ws-template");cc.set_Item(ch,I.FakeRootSingle(cg));}ci=b_.querySelectorAll("[ws-children-template]");for(cj=0,ck=ci.length-1;cj<=ck;cj++){cl=ci[cj];cm=cl.getAttribute("ws-children-template").toLowerCase();cl.removeAttribute("ws-children-template");cc.set_Item(cm,I.FakeRoot(cl));}cn=b_.querySelectorAll("template[id]");for(co=0,cp=cn.length-1;co<=cp;co++){cq=cn[co];cc.set_Item(cq.getAttribute("id").toLowerCase(),I.FakeRootFromHTMLTemplate(cq));}cr=b_.querySelectorAll("template[name]");for(cs=0,ct=cr.length-1;cs<=ct;cs++){cu=cr[cs];cc.set_Item(cu.getAttribute("name").toLowerCase(),I.FakeRootFromHTMLTemplate(cu));}cv=new S.New$3();while(cc.count>0)ca(E.head(cc.Keys()));};I.LoadedTemplates=function(){_5.$cctor();return _5.LoadedTemplates;};I.LoadedTemplateFile=function(b_){var b$,ca,cb;b$=(ca=null,[I.LoadedTemplates().TryGetValue(b_,{get:function(){return ca;},set:function(cc){ca=cc;}}),ca]);return b$[0]?b$[1]:(cb=new N.New$5(),(I.LoadedTemplates().set_Item(b_,cb),cb));};I.ChildrenTemplate=function(b_,b$){var ca,cb,cc,cd,ce;ca=I.InlineTemplate(b_,E.append(b$,I.GlobalHoles().Values()));cb=ca[1];cc=ca[0];cd=cc.Els;return!q.Equals(cd,null)&&cd.length===1&&(m.get(cd,0)instanceof P&&(q.Equals(m.get(cd,0).nodeType,P.ELEMENT_NODE)&&(ce=m.get(cd,0),true)))?ba.TreeNode(cc,cb):J.Mk({$:6,$0:cc},cb);};I.FakeRootSingle=function(b_){var b$,ca,cb,cc;b_.removeAttribute("ws-template");b$=b_.getAttribute("ws-replace");if(b$==null);else{b_.removeAttribute("ws-replace");ca=b_.parentNode;q.Equals(ca,null)?void 0:(cb=self.document.createElement(b_.tagName),cb.setAttribute("ws-replace",b$),ca.replaceChild(cb,b_));}cc=self.document.createElement("div");cc.appendChild(b_);return cc;};I.FakeRoot=function(b_){var b$;b$=self.document.createElement("div");while(b_.hasChildNodes())b$.appendChild(b_.firstChild);return b$;};I.FakeRootFromHTMLTemplate=function(b_){var b$,ca,cb,cc;b$=self.document.createElement("div");ca=b_.content;for(cb=0,cc=ca.childNodes.length-1;cb<=cc;cb++)b$.appendChild(ca.childNodes[cb].cloneNode(true));return b$;};I.PrepareTemplateStrict=function(b_,b$,ca,cb){var cc,cd;function ce(ck,cl){var cm,cn,co,cp,cq,cs,ct,cu,cv,cw,cx,cy,cz,cA,cB,cC,cD,cE,cF,cG,cH,cI,cJ,cK,cL,cM;function cr(cN){}while(true)switch(ck){case 0:if(cl!==null){cm=cl.nextSibling;if(q.Equals(cl.nodeType,P.TEXT_NODE))bc.convertTextNode(cl);else if(q.Equals(cl.nodeType,P.ELEMENT_NODE))cg(cl);cl=cm;}else return null;break;case 1:cs=bd.string(cl.nodeName,{$:1,$0:3},null).toLowerCase();ct=(cn=cs.indexOf("."),cn===-1?[b_,cs]:[bd.string(cs,null,{$:1,$0:cn-1}),bd.string(cs,{$:1,$0:cn+1},null)]);cu=ct[1];cv=ct[0];if(cv!=""&&!I.LoadedTemplates().ContainsKey(cv))return bc.failNotLoaded(cu);else{if(cv==""&&cb!=null)cb.$0(cu);cw=I.LoadedTemplates().Item(cv);if(!cw.ContainsKey(cu))return bc.failNotLoaded(cu);else{cx=cw.Item(cu);cy=cx.cloneNode(true);cz=new S.New$3();cA=new N.New$5();cB=cl.attributes;for(cC=0,cD=cB.length-1;cC<=cD;cC++){cE=cB.item(cC).name.toLowerCase();cA.set_Item(cE,(cF=cB.item(cC).nodeValue,cF==""?cE:cF.toLowerCase()));if(!cz.SAdd(cE))b7.warn("Hole mapped twice",cE);}for(cG=0,cH=cl.childNodes.length-1;cG<=cH;cG++){cI=cl.childNodes[cG];if(q.Equals(cI.nodeType,P.ELEMENT_NODE))!cz.SAdd(cI.nodeName.toLowerCase())?b7.warn("Hole filled twice",cu):void 0;}cJ=cl.childNodes.length===1&&q.Equals(cl.firstChild.nodeType,P.TEXT_NODE);if(cJ){cp=bc.fillTextHole(cy,cl.firstChild.textContent,cu);((function(cN){return function(cO){if(cO!=null)cN(cO.$0);};}((cq=function(cN){return function(cO){return cN.SAdd(cO);};}(cz),function(cN){return cr(cq(cN));})))(cp));}bc.removeHolesExcept(cy,cz);if(!cJ){for(cK=0,cL=cl.childNodes.length-1;cK<=cL;cK++){cM=cl.childNodes[cK];if(q.Equals(cM.nodeType,P.ELEMENT_NODE))cM.hasAttributes()?bc.fillInstanceAttrs(cy,cM):cf(cy,cM);}}bc.mapHoles(cy,cA);bc.fill(cy,cl.parentNode,cl);cl.parentNode.removeChild(cl);return;}}break;}}function cf(ck,cl){var cm,cn,cp,cq;function co(cr,cs){var ct;if(cp=="title"&&cl.hasChildNodes()){ct=be.ParseHTMLIntoFakeRoot(cl.textContent);cl.removeChild(cl.firstChild);while(ct.hasChildNodes())cl.appendChild(ct.firstChild);}else null;cg(cl);return bc.fill(cl,cr,cs);}cp=cl.nodeName.toLowerCase();I.foreachNotPreserved(ck,"[ws-attr-holes]",function(cr){var cs,ct,cu,cv,cw;cs=bw.SplitChars(cr.getAttribute("ws-attr-holes"),[" "],1);for(ct=0,cu=cs.length-1;ct<=cu;ct++){cv=m.get(cs,ct);cr.setAttribute(cv,(cw=new a.RegExp("\\${"+cp+"}","ig"),cr.getAttribute(cv).replace(cw,cl.textContent)));}});cq=ck.querySelector("[ws-hole="+cp+"]");if(q.Equals(cq,null)){cm=ck.querySelector("[ws-replace="+cp+"]");return q.Equals(cm,null)?(cn=ck.querySelector("slot[name="+cp+"]"),ck.tagName.toLowerCase()=="template"?(co(cn.parentNode,cn),void cn.parentNode.removeChild(cn)):null):(co(cm.parentNode,cm),void cm.parentNode.removeChild(cm));}else{while(cq.hasChildNodes())cq.removeChild(cq.lastChild);cq.removeAttribute("ws-hole");return co(cq,null);}}function cg(ck){if(!ck.hasAttribute("ws-preserve"))if(bw.StartsWith(ck.nodeName.toLowerCase(),"ws-"))ci(ck);else{bc.convertAttrs(ck);ch(ck.firstChild);}}function ch(ck){return ce(0,ck);}function ci(ck){return ce(1,ck);}function cj(ck){var cl,cm,cn,co,cp,cq,cr,cs,ct,cu,cv,cw;while(true){cl=ck.querySelector("[ws-template]");if(q.Equals(cl,null)){cm=ck.querySelector("[ws-children-template]");if(q.Equals(cm,null)){cn=ck.querySelectorAll("template[id]");for(co=1,cp=cn.length-1;co<=cp;co++){cq=cn[co];if(cc.Contains(cq));else{I.PrepareTemplateStrict(b_,{$:1,$0:cq.getAttribute("id")},cq,null);cc.SAdd(cq);}}cr=ck.querySelectorAll("template[name]");for(cs=1,ct=cr.length-1;cs<=ct;cs++){cu=cr[cs];if(cc.Contains(cu));else{I.PrepareTemplateStrict(b_,{$:1,$0:cu.getAttribute("name")},cu,null);cc.SAdd(cu);}}return null;}else{cv=cm.getAttribute("ws-children-template");cm.removeAttribute("ws-children-template");I.PrepareTemplateStrict(b_,{$:1,$0:cv},cm,null);ck=ck;}}else{cw=cl.getAttribute("ws-template");(I.PrepareSingleTemplate(b_,{$:1,$0:cw},cl))(null);ck=ck;}}}cc=new S.New$3();cd=(b$==null?"":b$.$0).toLowerCase();I.LoadedTemplateFile(b_).set_Item(cd,ca);if(ca.hasChildNodes()){cj(ca);ch(ca.firstChild);}};I.InlineTemplate=function(b_,b$){var ca,cb,cc,cd,ce,ci,cj,ck,cl,cm,cn,co;function cf(cp,cq){var cr,cs,ct;cr=bn.Insert(cp,cq);cj.push(bn.Updates(cr));ck.push([cp,cr]);cs=b6.GetOptional(cr.OnAfterRender);return cs==null?null:(ct=cs.$0,void cl.push(function(){ct(cp);}));}function cg(cp){var cq,cr,cs,ct;cq=(cr=null,[cm.TryGetValue(cp,{get:function(){return cr;},set:function(cu){cr=cu;}}),cr]);return cq[0]?(cs=cq[1],cs instanceof y?{$:1,$0:cs.get_Value()}:cs instanceof C?{$:1,$0:J.TextNode(cs.get_Value())}:(ct=cs.ForTextView(),ct==null?null:{$:1,$0:J.TextView(ct.$0)})):null;}function ch(){I.foreachNotPreservedwsDOM("[ws-dom]",function(cp){var cq,cr,cs,ct,cu,cv,cw;cq=(cr=null,[cm.TryGetValue(cp.getAttribute("ws-dom").toLowerCase(),{get:function(){return cr;},set:function(cx){cr=cx;}}),cr]);if(cq[0]){cs=cq[1];cs instanceof Z?(ct=cs.get_Value(),cp.removeAttribute("ws-dom"),cu=cp,cv=new a.MutationObserver(function(cx,cy){m.iter(function(cz){function cA(cB,cC,cD,cE){if(cB===cu&&cz.addedNodes.length!==1){ct.SetFinal(null);cy.disconnect();}}cz.removedNodes.forEach(b6.CreateFuncWithArgs(function(cB){return cA(cB[0],cB[1],cB[2],cB[3]);}),null);},cx);}),cp.parentElement!==null?cv.observe(cp.parentElement,(cw={},cw.childList=true,cw)):void 0,ct.Set({$:1,$0:cp}),Q.Sink(function(cx){var cy;if(cx!=null&&cx.$==1){cy=cx.$0;if(cu===cy);else{cu.replaceWith.apply(cu,[cy]);cu=cy;}}else{cu.remove();cv.disconnect();}},ct.get_View())):void 0;}});}ci=[];cj=[];ck=[];cl=[];cm=new N.New$5();cn=_2.Get(b$);try{while(cn.MoveNext()){co=cn.Current();cm.set_Item(co.get_Name(),co);}}finally{if(typeof cn=="object"&&"Dispose"in cn)cn.Dispose();}ca=be.ChildrenArray(b_);I.foreachNotPreserved(b_,"[ws-hole]",function(cp){var cq,cr,cs;cs=cp.getAttribute("ws-hole");cp.removeAttribute("ws-hole");while(cp.hasChildNodes())cp.removeChild(cp.lastChild);cq=cg(cs);if(cq!=null&&cq.$==1){cr=cq.$0;_6.LinkElement(cp,cr.docNode);ci.push(_8.New(bn.Empty(cp),cr.docNode,null,cp,L.Int(),null));cj.push(cr.updates);}});I.foreachNotPreserved(b_,"[ws-replace]",function(cp){var cq,cr,cs,ct,cu,cv;cq=cg(cp.getAttribute("ws-replace"));if(cq!=null&&cq.$==1){cr=cq.$0;cs=cp.parentNode;ct=self.document.createTextNode("");cs.replaceChild(ct,cp);cu=_6.InsertBeforeDelim(ct,cr.docNode);cv=m.tryFindIndex(function(cw){return cp===cw;},ca);cv==null?void 0:m.set(ca,cv.$0,cr.docNode);ci.push(_8.New(bn.Empty(cs),cr.docNode,{$:1,$0:[cu,ct]},cs,L.Int(),null));cj.push(cr.updates);}});cb=false;I.foreachNotPreserved(b_,"slot",function(cp){var cq,cr,cs,ct;cs=cp.getAttribute("name");ct=cs==""||cs==null?"default":cs.toLowerCase();if(cb&&ct=="default"||!q.Equals(b_.parentElement,null))void 0;else{while(cp.hasChildNodes())cp.removeChild(cp.lastChild);if(ct=="default")cb=true;cq=cg(ct);if(cq!=null&&cq.$==1){cr=cq.$0;_6.LinkElement(cp,cr.docNode);ci.push(_8.New(bn.Empty(cp),cr.docNode,null,cp,L.Int(),null));cj.push(cr.updates);}}});I.foreachNotPreserved(b_,"[ws-attr]",function(cp){var cq,cr,cs,ct;cq=cp.getAttribute("ws-attr");cp.removeAttribute("ws-attr");cr=(cs=null,[cm.TryGetValue(cq,{get:function(){return cs;},set:function(cu){cs=cu;}}),cs]);if(cr[0]){ct=cr[1];ct instanceof bo?cf(cp,ct.get_Value()):b7.warn("Attribute hole filled with non-attribute data",cq);}});I.foreachNotPreserved(b_,"[ws-on]",function(cp){cf(cp,br.Concat(m.choose(function(cq){var cr,cs,ct,cu;cr=bw.SplitChars(cq,[":"],1);cs=(ct=null,[cm.TryGetValue(m.get(cr,1),{get:function(){return ct;},set:function(cv){ct=cv;}}),ct]);return cs[0]?(cu=cs[1],cu instanceof bp?{$:1,$0:bq.Handler(m.get(cr,0),cu.get_Value())}:cu instanceof D?{$:1,$0:br.Handler(m.get(cr,0),cu.get_Value())}:(b7.warn("Event hole on"+m.get(cr,0)+" filled with non-event data",m.get(cr,1)),null)):null;},bw.SplitChars(cp.getAttribute("ws-on"),[" "],1))));cp.removeAttribute("ws-on");});I.foreachNotPreserved(b_,"[ws-onafterrender]",function(cp){var cq,cr,cs,ct;cq=cp.getAttribute("ws-onafterrender");cr=(cs=null,[cm.TryGetValue(cq,{get:function(){return cs;},set:function(cu){cs=cu;}}),cs]);if(cr[0]){ct=cr[1];ct instanceof bs?(cp.removeAttribute("ws-onafterrender"),cf(cp,bq.OnAfterRender(ct.get_Value()))):ct instanceof bt?(cp.removeAttribute("ws-onafterrender"),cf(cp,bq.OnAfterRender(ct.get_Value()))):b7.warn("onafterrender hole filled with non-onafterrender data",cq);}});I.foreachNotPreserved(b_,"[ws-var]",function(cp){var cq,cr,cs;cq=cp.getAttribute("ws-var");cp.removeAttribute("ws-var");cr=(cs=null,[cm.TryGetValue(cq,{get:function(){return cs;},set:function(ct){cs=ct;}}),cs]);if(cr[0])cr[1].AddAttribute(function(ct){return function(cu){return cf(ct,cu);};},cp);});I.foreachNotPreserved(b_,"[ws-attr-holes]",function(cp){var cq,cr,cs,ct;cq=new a.RegExp(I.TextHoleRE(),"g");cr=bw.SplitChars(cp.getAttribute("ws-attr-holes"),[" "],1);cp.removeAttribute("ws-attr-holes");for(cs=0,ct=cr.length-1;cs<=ct;cs++)(function(){var cu,cv,cw,cx,cy,cz,cA,cB,cC,cD,cE,cF,cG;cD=m.get(cr,cs);cE=cp.getAttribute(cD);cu=null;cv=0;cF=[];while(cu=cq.exec(cE),cu!==null){cG=bd.string(cE,{$:1,$0:cv},{$:1,$0:cq.lastIndex-m.get(cu,0).length-1});cv=cq.lastIndex;cF.push([cG,m.get(cu,1)]);}cx=bd.string(cE,{$:1,$0:cv},null);cq.lastIndex=0;cy=m.foldBack(function(cH,cI){return(function(cJ){var cK,cL;cK=cJ[0];cL=cJ[1];return function(cM){var cN,cO,cP,cQ,cR;cN=cM[0];cO=cM[1];cP=(cQ=(cR=null,[cm.TryGetValue(cL,{get:function(){return cR;},set:function(cS){cR=cS;}}),cR]),cQ[0]?cQ[1].get_AsChoiceView():{$:0,$0:""});return cP.$==1?[cK,new bv({$:1,$0:cN==""?cP.$0:Q.Map(function(cS){return cS+cN;},cP.$0),$1:cO})]:[cK+cP.$0+cN,cO];};}(cH))(cI);},cF,[cx,bv.Empty]);return cf(cp,cy[1].$==1?cy[1].$1.$==1?cy[1].$1.$1.$==1?cy[1].$1.$1.$1.$==0?(cz=cy[0],bq.Dynamic(cD,Q.Map3(function(cH,cI,cJ){return cz+cH+cI+cJ;},cy[1].$0,cy[1].$1.$0,cy[1].$1.$1.$0))):(cA=cy[0],bq.Dynamic(cD,Q.Map(function(cH){return cA+bw.concat("",cH);},Q.Sequence(cy[1])))):(cB=cy[0],bq.Dynamic(cD,Q.Map2(function(cH,cI){return cB+cH+cI;},cy[1].$0,cy[1].$1.$0))):cy[0]==""?bq.Dynamic(cD,cy[1].$0):(cC=cy[0],bq.Dynamic(cD,Q.Map(function(cH){return cC+cH;},cy[1].$0))):br.Create(cD,cy[0]));}());});return[b6.DeleteEmptyFields({Els:ca,Dirty:true,Holes:ci,Attrs:ck,Render:(cc=cl.length==0?{$:1,$0:function(){ch();}}:{$:1,$0:function(cp){ch();m.iter(function(cq){cq(cp);},cl);}},cc?cc.$0:void 0),El:(cd=!q.Equals(ca,null)&&ca.length===1&&(m.get(ca,0)instanceof P&&(m.get(ca,0)instanceof bb&&(ce=m.get(ca,0),true)))?{$:1,$0:ce}:null,cd?cd.$0:void 0)},["Render","El"]),bl.TreeReduce(Q.Const(),Q.Map2Unit,cj)];};I.GlobalHoles=function(){_5.$cctor();return _5.GlobalHoles;};I.foreachNotPreserved=function(b_,b$,ca){be.IterSelector(b_,b$,function(cb){if(cb.closest("[ws-preserve]")==null)ca(cb);});};I.PrepareSingleTemplate=function(b_,b$,ca){var cb;cb=I.FakeRootSingle(ca);return function(cc){I.PrepareTemplateStrict(b_,b$,cb,cc);};};I.foreachNotPreservedwsDOM=function(b_,b$){be.IterSelectorDoc(b_,function(ca){if(ca.closest("[ws-preserve]")==null)b$(ca);});};I.TextHoleRE=function(){_5.$cctor();return _5.TextHoleRE;};J=f.Doc=b6.Class({},e,J);J.RunById=function(b_,b$){var ca;ca=self.document.getElementById(b_);if(q.Equals(ca,null))h.FailWith("invalid id: "+b_);else J.Run(ca,b$);};J.Convert=function(b_,b$){return J.Flatten(Q.MapSeqCached(b_,b$));};J.Run=function(b_,b$){_6.LinkElement(b_,b$.docNode);J.RunInPlace(false,b_,b$);};J.Flatten=function(b_){return J.EmbedView(Q.Map(J.Concat,b_));};J.get_Empty=function(){return J.Mk(null,Q.Const());};J.RunInPlace=function(b_,b$,ca){var cb;cb=_6.CreateRunState(b$,ca.docNode);Q.Sink(bg.get_UseAnimations()||bh.BatchUpdatesEnabled()?bi.StartProcessor(_6.PerformAnimatedUpdate(b_,cb,ca.docNode)):function(){_6.PerformSyncUpdate(b_,cb,ca.docNode);},ca.updates);};J.Concat=function(b_){var b$;b$=bl.ofSeqNonCopying(b_);return bl.TreeReduce(J.get_Empty(),J.Append,b$);};J.EmbedView=function(b_){var b$;b$=_6.CreateEmbedNode();return J.Mk({$:2,$0:b$},Q.Map(a.ignore,Q.Bind(function(ca){_6.UpdateEmbedNode(b$,ca.docNode);return ca.updates;},b_)));};J.Mk=function(b_,b$){return new J.New(b_,b$);};J.Append=function(b_,b$){return J.Mk({$:0,$0:b_.docNode,$1:b$.docNode},Q.Map2Unit(b_.updates,b$.updates));};J.TextNode=function(b_){return J.Mk({$:5,$0:self.document.createTextNode(b_)},Q.Const());};J.TextView=function(b_){var b$;b$=_6.CreateTextNode();return J.Mk({$:4,$0:b$},Q.Map(function(ca){_6.UpdateTextNode(b$,ca);},b_));};J.New=b6.Ctor(function(b_,b$){e.New.call(this);this.docNode=b_;this.updates=b$;},J);L.Int=function(){L.set_counter(L.counter()+1);return L.counter();};L.set_counter=function(b_){_7.$cctor();_7.counter=b_;};L.counter=function(){_7.$cctor();return _7.counter;};N=M.Dictionary=b6.Class({set_Item:function(b_,b$){this.set(b_,b$);},Clear:function(){this.data=[];this.count=0;},set:function(b_,b$){var ca,cb,cc,cd;ca=this;cb=this.hash(b_);cc=this.data[cb];if(cc==null){this.count=this.count+1;this.data[cb]=new a.Array({K:b_,V:b$});}else{cd=m.tryFindIndex(function(ce){return ca.equals.apply(null,[(h.KeyValue(ce))[0],b_]);},cc);cd==null?(this.count=this.count+1,cc.push({K:b_,V:b$})):cc[cd.$0]={K:b_,V:b$};}},TryGetValue:function(b_,b$){var ca,cb,cc;ca=this;cb=this.data[this.hash(b_)];return cb==null?false:(cc=m.tryPick(function(cd){var ce;ce=h.KeyValue(cd);return ca.equals.apply(null,[ce[0],b_])?{$:1,$0:ce[1]}:null;},cb),cc!=null&&cc.$==1&&(b$.set(cc.$0),true));},RemoveKey:function(b_){return this.remove(b_);},ContainsKey:function(b_){var b$,ca;b$=this;ca=this.data[this.hash(b_)];return ca==null?false:m.exists(function(cb){return b$.equals.apply(null,[(h.KeyValue(cb))[0],b_]);},ca);},Keys:function(){return new bf.New(this);},GetEnumerator:function(){return _2.Get0(m.concat(Y.GetFieldValues(this.data)));},Values:function(){return new by.New(this);},remove:function(b_){var b$,ca,cb,cc;b$=this;ca=this.hash(b_);cb=this.data[ca];return cb==null?false:(cc=m.filter(function(cd){return!b$.equals.apply(null,[(h.KeyValue(cd))[0],b_]);},cb),m.length(cc)<cb.length&&(this.count=this.count-1,this.data[ca]=cc,true));},Item:function(b_){return this.get(b_);},get:function(b_){var b$,ca;b$=this;ca=this.data[this.hash(b_)];return ca==null?_1.notPresent():m.pick(function(cb){var cc;cc=h.KeyValue(cb);return b$.equals.apply(null,[cc[0],b_])?{$:1,$0:cc[1]}:null;},ca);}},e,N);N.New$5=b6.Ctor(function(){N.New$6.call(this,[],q.Equals,q.Hash);},N);N.New$6=b6.Ctor(function(b_,b$,ca){var cb,cc;e.New.call(this);this.equals=b$;this.hash=ca;this.count=0;this.data=[];cb=_2.Get(b_);try{while(cb.MoveNext()){cc=cb.Current();this.set(cc.K,cc.V);}}finally{if(typeof cb=="object"&&"Dispose"in cb)cb.Dispose();}},N);Q=f.View=b6.Class({},null,Q);v.Obsolete=function(b_){var b$,ca,cb,cc,cd;ca=b_.s;if(ca==null||(ca!=null&&ca.$==2?(b$=ca.$1,false):ca!=null&&ca.$==3?(b$=ca.$1,false):true))void 0;else{b_.s=null;for(cb=0,cc=m.length(b$)-1;cb<=cc;cb++){cd=m.get(b$,cb);if(typeof cd=="object")(function(ce){v.Obsolete(ce);}(cd));else cd();}}};v.New=function(b_){return{s:b_};};o.FromSeq=function(b_){return o.Create(a.id,b_);};o.Create=function(b_,b$){return o.CreateWithStorage(b_,_.InMemory(m.ofSeq(b$)));};o.CreateWithStorage=function(b_,b$){return new o.New(b_,b$);};S=M.HashSet=b6.Class({SAdd:function(b_){return this.add(b_);},Contains:function(b_){var b$;b$=this.data[this.hash(b_)];return b$==null?false:this.arrContains(b_,b$);},add:function(b_){var b$,ca;b$=this.hash(b_);ca=this.data[b$];return ca==null?(this.data[b$]=[b_],this.count=this.count+1,true):this.arrContains(b_,ca)?false:(ca.push(b_),this.count=this.count+1,true);},arrContains:function(b_,b$){var ca,cb,cc,cd;ca=true;cb=0;cd=b$.length;while(ca&&cb<cd)if(this.equals.apply(null,[b$[cb],b_]))ca=false;else cb=cb+1;return!ca;},GetEnumerator:function(){return _2.Get(bF.concat(this.data));},ExceptWith:function(b_){var b$;b$=_2.Get(b_);try{while(b$.MoveNext())this.Remove(b$.Current());}finally{if(typeof b$=="object"&&"Dispose"in b$)b$.Dispose();}},Count:function(){return this.count;},IntersectWith:function(b_){var b$,ca,cb,cc,cd;b$=new S.New$4(b_,this.equals,this.hash);ca=bF.concat(this.data);for(cb=0,cc=ca.length-1;cb<=cc;cb++){cd=ca[cb];if(!b$.Contains(cd))this.Remove(cd);}},Remove:function(b_){var b$;b$=this.data[this.hash(b_)];return b$==null?false:this.arrRemove(b_,b$)&&(this.count=this.count-1,true);},CopyTo:function(b_,b$){var ca,cb,cc;ca=bF.concat(this.data);for(cb=0,cc=ca.length-1;cb<=cc;cb++)m.set(b_,cb+b$,ca[cb]);},arrRemove:function(b_,b$){var ca,cb,cc,cd;ca=true;cb=0;cd=b$.length;while(ca&&cb<cd)if(this.equals.apply(null,[b$[cb],b_])){b$.splice.apply(b$,[cb,1]);ca=false;}else cb=cb+1;return!ca;}},e,S);S.New$3=b6.Ctor(function(){S.New$4.call(this,[],q.Equals,q.Hash);},S);S.New$4=b6.Ctor(function(b_,b$,ca){var cb;e.New.call(this);this.equals=b$;this.hash=ca;this.data=[];this.count=0;cb=_2.Get(b_);try{while(cb.MoveNext())this.add(cb.Current());}finally{if(typeof cb=="object"&&"Dispose"in cb)cb.Dispose();}},S);S.New$2=b6.Ctor(function(b_){S.New$4.call(this,b_,q.Equals,q.Hash);},S);m.choose=function(b_,b$){var ca,cb,cc,cd;ca=[];for(cb=0,cc=b$.length-1;cb<=cc;cb++){cd=b_(b$[cb]);if(cd==null);else ca.push(cd.$0);}return ca;};m.tryFindIndex=function(b_,b$){var ca,cb;ca=null;cb=0;while(cb<b$.length&&ca==null){b_(b$[cb])?ca={$:1,$0:cb}:void 0;cb=cb+1;}return ca;};m.tryPick=function(b_,b$){var ca,cb,cc;ca=null;cb=0;while(cb<b$.length&&ca==null){cc=b_(b$[cb]);if(cc!=null&&cc.$==1)ca=cc;cb=cb+1;}return ca;};m.exists=function(b_,b$){var ca,cb,cc,cd;ca=false;cb=0;cd=m.length(b$);while(!ca&&cb<cd)if(b_(b$[cb]))ca=true;else cb=cb+1;return ca;};m.concat=function(b_){return a.Array.prototype.concat.apply([],m.ofSeq(b_));};m.ofSeq=function(b_){var b$,ca;if(b_ instanceof a.Array)return b_.slice();else if(b_ instanceof bv)return m.ofList(b_);else{b$=[];ca=_2.Get(b_);try{while(ca.MoveNext())b$.push(ca.Current());return b$;}finally{if(typeof ca=="object"&&"Dispose"in ca)ca.Dispose();}}};m.iter=function(b_,b$){var ca,cb;for(ca=0,cb=b$.length-1;ca<=cb;ca++)b_(b$[ca]);};m.foldBack=function(b_,b$,ca){var cb,cc,cd,ce,cf;cb=ca;cd=b$.length;for(ce=1,cf=cd;ce<=cf;ce++)cb=b_(b$[cd-ce],cb);return cb;};m.map=function(b_,b$){var ca,cb,cc;ca=new a.Array(b$.length);for(cb=0,cc=b$.length-1;cb<=cc;cb++)ca[cb]=b_(b$[cb]);return ca;};m.filter=function(b_,b$){var ca,cb,cc;ca=[];for(cb=0,cc=b$.length-1;cb<=cc;cb++)if(b_(b$[cb]))ca.push(b$[cb]);return ca;};m.ofList=function(b_){var b$,ca;ca=[];b$=b_;while(!(b$.$==0)){ca.push(bu.head(b$));b$=bu.tail(b$);}return ca;};m.pick=function(b_,b$){var ca;ca=m.tryPick(b_,b$);return ca==null?h.FailWith("KeyNotFoundException"):ca.$0;};m.forall=function(b_,b$){var ca,cb,cc,cd;ca=true;cb=0;cd=m.length(b$);while(ca&&cb<cd)if(b_(b$[cb]))cb=cb+1;else ca=false;return ca;};m.create=function(b_,b$){var ca,cb,cc;ca=new a.Array(b_);for(cb=0,cc=b_-1;cb<=cc;cb++)ca[cb]=b$;return ca;};m.init=function(b_,b$){var ca,cb,cc;if(b_<0)h.FailWith("Negative size given.");else null;ca=new a.Array(b_);for(cb=0,cc=b_-1;cb<=cc;cb++)ca[cb]=b$(cb);return ca;};T.$cctor=function(){T.$cctor=a.ignore;T.initialized=new N.New$5();};T=k.TemplateInitializer=b6.Class({},e,T);T.GetOrAddHoleFor=function(b_,b$,ca){var cb,cc,cd,ce;T.$cctor();cb=T.GetHolesFor(b_);cc=(cd=null,[cb.TryGetValue(b$,{get:function(){return cd;},set:function(cf){cd=cf;}}),cd]);return cc[0]?cc[1]:(ce=ca(),(cb.set_Item(b$,ce),ce));};T.GetHolesFor=function(b_){var b$,ca,cb;T.$cctor();b$=(ca=null,[T.initialized.TryGetValue(b_,{get:function(){return ca;},set:function(cc){ca=cc;}}),ca]);return b$[0]?b$[1]:(cb=new N.New$5(),(T.initialized.set_Item(b_,cb),cb));};U=w.VarFloatUnchecked=b6.Class({get_Name:function(){return this.name;},ForTextView:function(){return{$:1,$0:Q.Map(a.String,this.fillWith.get_View())};},AddAttribute:function(b_,b$){(b_(b$))(bq.FloatValueUnchecked(this.fillWith));},get_AsChoiceView:function(){return{$:1,$0:Q.Map(a.String,this.fillWith.get_View())};}},p,U);U.New=b6.Ctor(function(b_,b$){p.New.call(this);this.name=b_;this.fillWith=b$;},U);V=w.VarBool=b6.Class({get_Name:function(){return this.name;},ForTextView:function(){return{$:1,$0:Q.Map(a.String,this.fillWith.get_View())};},AddAttribute:function(b_,b$){(b_(b$))(bq.Checked(this.fillWith));},get_AsChoiceView:function(){return{$:1,$0:Q.Map(a.String,this.fillWith.get_View())};}},p,V);V.New=b6.Ctor(function(b_,b$){p.New.call(this);this.name=b_;this.fillWith=b$;},V);W=w.VarDateTime=b6.Class({get_Name:function(){return this.name;},ForTextView:function(){return{$:1,$0:Q.Map(function(b_){return(new a.Date(b_)).toLocaleString();},this.fillWith.get_View())};},AddAttribute:function(b_,b$){(b_(b$))(bq.DateTimeValue(this.fillWith));},get_AsChoiceView:function(){return{$:1,$0:Q.Map(function(b_){return(new a.Date(b_)).toLocaleString();},this.fillWith.get_View())};}},p,W);W.New=b6.Ctor(function(b_,b$){p.New.call(this);this.name=b_;this.fillWith=b$;},W);X=w.VarFile=b6.Class({get_Name:function(){return this.name;},ForTextView:function(){return{$:1,$0:Q.Map(a.String,this.fillWith.get_View())};},AddAttribute:function(b_,b$){(b_(b$))(bq.FileValue(this.fillWith));},get_AsChoiceView:function(){return{$:1,$0:Q.Map(a.String,this.fillWith.get_View())};}},p,X);X.New=b6.Ctor(function(b_,b$){p.New.call(this);this.name=b_;this.fillWith=b$;},X);Y.GetFieldValues=function(b_){var b$,ca;b$=[];for(var cb in b_)b$.push(b_[cb]);return b$;};Z=w.VarDomElement=b6.Class({get_Name:function(){return this.name;},get_Value:function(){return this.fillWith;}},p,Z);Z.New=b6.Ctor(function(b_,b$){p.New.call(this);this.name=b_;this.fillWith=b$;},Z);_0.TryParseInt32=function(b_,b$){return _0.TryParse(b_,-2147483648,2147483647,b$);};Q.MapSeqCached=function(b_,b$){return Q.MapSeqCachedBy(a.id,b_,b$);};Q.MapSeqCachedBy=function(b_,b$,ca){var cb;cb=[new N.New$5()];return Q.Map(function(cc){var cd,ce,cf;cd=cb[0];ce=new N.New$5();cf=bl.mapInPlace(function(cg){var ch,ci;ch=b_(cg);ci=cd.ContainsKey(ch)?cd.Item(ch):b$(cg);ce.set_Item(ch,ci);return ci;},m.ofSeq(cc));cb[0]=ce;return cf;},ca);};Q.Map=function(b_,b$){return Q.CreateLazy(function(){return v.Map(b_,b$());});};Q.Const=function(b_){var b$;b$=v.New({$:0,$0:b_});return function(){return b$;};};Q.Sink=function(b_,b$){function ca(){v.WhenRun(b$(),b_,function(){bC.scheduler().Fork(ca);});}bC.scheduler().Fork(ca);};Q.CreateLazy=function(b_){var b$;b$={c:null,o:b_};return function(){var ca,cb;ca=b$.c;return ca===null?(ca=b$.o(),b$.c=ca,(cb=ca.s,cb!=null&&cb.$==0)?b$.o=null:v.WhenObsoleteRun(ca,function(){b$.c=null;}),ca):ca;};};Q.Bind=function(b_,b$){return Q.Join(Q.Map(b_,b$));};Q.Map3=function(b_,b$,ca,cb){return Q.CreateLazy(function(){return v.Map3(b_,b$(),ca(),cb());});};Q.Sequence=function(b_){return Q.CreateLazy(function(){return v.Sequence(E.map(function(b$){return b$();},b_));});};Q.Map2=function(b_,b$,ca){return Q.CreateLazy(function(){return v.Map2(b_,b$(),ca());});};Q.Map2Unit=function(b_,b$){return Q.CreateLazy(function(){return v.Map2Unit(b_(),b$());});};Q.Join=function(b_){return Q.CreateLazy(function(){return v.Join(b_());});};_1.notPresent=function(){throw new bL.New();};_2.Get=function(b_){return b_ instanceof a.Array?_2.ArrayEnumerator(b_):q.Equals(typeof b_,"string")?_2.StringEnumerator(b_):b_.GetEnumerator();};_2.ArrayEnumerator=function(b_){return new _3.New(0,null,function(b$){var ca;ca=b$.s;return ca<m.length(b_)&&(b$.c=m.get(b_,ca),b$.s=ca+1,true);},void 0);};_2.StringEnumerator=function(b_){return new _3.New(0,null,function(b$){var ca;ca=b$.s;return ca<b_.length&&(b$.c=b_[ca],b$.s=ca+1,true);},void 0);};_2.Get0=function(b_){return b_ instanceof a.Array?_2.ArrayEnumerator(b_):q.Equals(typeof b_,"string")?_2.StringEnumerator(b_):"GetEnumerator0"in b_?b_.GetEnumerator0():b_.GetEnumerator();};_3=_2.T=b6.Class({MoveNext:function(){var b_;b_=this.n(this);this.e=b_?1:2;return b_;},Current:function(){return this.e===1?this.c:this.e===0?h.FailWith("Enumeration has not started. Call MoveNext."):h.FailWith("Enumeration already finished.");},Dispose:function(){if(this.d)this.d(this);}},e,_3);_3.New=b6.Ctor(function(b_,b$,ca,cb){e.New.call(this);this.s=b_;this.c=b$;this.n=ca;this.d=cb;this.e=0;},_3);_5.$cctor=function(){_5.$cctor=a.ignore;_5.LoadedTemplates=new N.New$5();_5.LocalTemplatesLoaded=false;_5.GlobalHoles=new N.New$5();_5.TextHoleRE="\\${([^}]+)}";_5.RenderedFullDocTemplate=null;};_6.LinkElement=function(b_,b$){_6.InsertDoc(b_,b$,null);};_6.InsertDoc=function(b_,b$,ca){var cb,cc,cd;while(true)if(b$!=null&&b$.$==1)return _6.InsertNode(b_,b$.$0.El,ca);else if(b$!=null&&b$.$==2){cb=b$.$0;cb.Dirty=false;b$=cb.Current;}else if(b$==null)return ca;else if(b$!=null&&b$.$==4)return _6.InsertNode(b_,b$.$0.Text,ca);else if(b$!=null&&b$.$==5)return _6.InsertNode(b_,b$.$0,ca);else if(b$!=null&&b$.$==6)return m.foldBack(function(ce,cf){return(((b6.Curried3(function(cg,ch,ci){return ch==null||ch.constructor===R?_6.InsertDoc(cg,ch,ci):_6.InsertNode(cg,ch,ci);}))(b_))(ce))(cf);},b$.$0.Els,ca);else{cc=b$.$1;cd=b$.$0;b$=cd;ca=_6.InsertDoc(b_,cc,ca);}};_6.CreateRunState=function(b_,b$){return bA.New(bB.get_Empty(),_6.CreateElemNode(b_,bn.EmptyAttr(),b$));};_6.PerformAnimatedUpdate=function(b_,b$,ca){var cb;return bg.get_UseAnimations()?(cb=null,bC.Delay(function(){var cc,cd,ce;cc=bB.FindAll(ca);cd=_6.ComputeChangeAnim(b$,cc);ce=_6.ComputeEnterAnim(b$,cc);return bC.Bind(bg.Play(bg.Append(cd,_6.ComputeExitAnim(b$,cc))),function(){return bC.Bind(_6.SyncElemNodesNextFrame(b_,b$),function(){return bC.Bind(bg.Play(ce),function(){b$.PreviousNodes=cc;return bC.Return(null);});});});})):_6.SyncElemNodesNextFrame(b_,b$);};_6.PerformSyncUpdate=function(b_,b$,ca){var cb;cb=bB.FindAll(ca);_6.SyncElemNode(b_,b$.Top);b$.PreviousNodes=cb;};_6.CreateEmbedNode=function(){return{Current:null,Dirty:false};};_6.UpdateEmbedNode=function(b_,b$){b_.Current=b$;b_.Dirty=true;};_6.InsertBeforeDelim=function(b_,b$){var ca,cb;ca=b_.parentNode;cb=self.document.createTextNode("");ca.insertBefore(cb,b_);_6.LinkPrevElement(b_,b$);return cb;};_6.InsertNode=function(b_,b$,ca){be.InsertAt(b_,ca,b$);return b$;};_6.CreateElemNode=function(b_,b$,ca){var cb;_6.LinkElement(b_,ca);cb=bn.Insert(b_,b$);return _8.New(cb,ca,null,b_,L.Int(),b6.GetOptional(cb.OnAfterRender));};_6.SyncElemNodesNextFrame=function(b_,b$){function ca(cb){a.requestAnimationFrame(function(){_6.SyncElemNode(b_,b$.Top);cb();});}return bh.BatchUpdatesEnabled()?bC.FromContinuations(function(cb,cc,cd){return ca.apply(null,[cb,cc,cd]);}):(_6.SyncElemNode(b_,b$.Top),bC.Return(null));};_6.ComputeExitAnim=function(b_,b$){return bg.Concat(m.map(function(ca){return bn.GetExitAnim(ca.Attr);},bB.ToArray(bB.Except(b$,bB.Filter(function(ca){return bn.HasExitAnim(ca.Attr);},b_.PreviousNodes)))));};_6.ComputeEnterAnim=function(b_,b$){return bg.Concat(m.map(function(ca){return bn.GetEnterAnim(ca.Attr);},bB.ToArray(bB.Except(b_.PreviousNodes,bB.Filter(function(ca){return bn.HasEnterAnim(ca.Attr);},b$)))));};_6.ComputeChangeAnim=function(b_,b$){var ca;function cb(cc){return bn.HasChangeAnim(cc.Attr);}ca=function(cc){return bB.Filter(cb,cc);};return bg.Concat(m.map(function(cc){return bn.GetChangeAnim(cc.Attr);},bB.ToArray(bB.Intersect(ca(b_.PreviousNodes),ca(b$)))));};_6.SyncElemNode=function(b_,b$){!b_?_6.SyncElement(b$):void 0;_6.Sync(b$.Children);_6.AfterRender(b$);};_6.CreateTextNode=function(){return{Text:self.document.createTextNode(""),Dirty:false,Value:""};};_6.UpdateTextNode=function(b_,b$){b_.Value=b$;b_.Dirty=true;};_6.LinkPrevElement=function(b_,b$){_6.InsertDoc(b_.parentNode,b$,b_);};_6.SyncElement=function(b_){function b$(ca){function cb(cc){var cd,ce,cf,cg;while(true){if(cc!=null&&cc.$==0){ce=cc.$1;cf=cc.$0;if(cb(cf))return true;else cc=ce;}else if(cc!=null&&cc.$==2){cg=cc.$0;if(cg.Dirty)return true;else cc=cg.Current;}else return cc!=null&&cc.$==6&&(cd=cc.$0,cd.Dirty||m.exists(b$,cd.Holes));}}return cb(ca.Children);}bn.Sync(b_.El,b_.Attr);if(b$(b_))_6.DoSyncElement(b_);};_6.Sync=function(b_){var b$,ca,cb,cc,cd;while(true){if(b_!=null&&b_.$==1)return _6.SyncElemNode(false,b_.$0);else if(b_!=null&&b_.$==2){cb=b_.$0;b_=cb.Current;}else if(b_==null)return null;else if(b_!=null&&b_.$==5)return null;else if(b_!=null&&b_.$==4){b$=b_.$0;return b$.Dirty?(b$.Text.nodeValue=b$.Value,b$.Dirty=false):null;}else if(b_!=null&&b_.$==6){ca=b_.$0;m.iter(function(ce){_6.SyncElemNode(false,ce);},ca.Holes);m.iter(function(ce){bn.Sync(ce[0],ce[1]);},ca.Attrs);return _6.AfterRender(ca);}else{cc=b_.$1;cd=b_.$0;_6.Sync(cd);b_=cc;}}};_6.AfterRender=function(b_){var b$;b$=b6.GetOptional(b_.Render);if(b$!=null&&b$.$==1){b$.$0(b_.El);b6.SetOptional(b_,"Render",null);}};_6.DoSyncElement=function(b_){var b$,ca,cb;function cc(cd,ce){var cf,cg,ch,ci;while(true){if(cd!=null&&cd.$==1)return cd.$0.El;else if(cd!=null&&cd.$==2){cg=cd.$0;if(cg.Dirty){cg.Dirty=false;return _6.InsertDoc(b$,cg.Current,ce);}else cd=cg.Current;}else if(cd==null)return ce;else if(cd!=null&&cd.$==4)return cd.$0.Text;else if(cd!=null&&cd.$==5)return cd.$0;else if(cd!=null&&cd.$==6){cf=cd.$0;cf.Dirty?cf.Dirty=false:void 0;return m.foldBack(function(cj,ck){return cj==null||cj.constructor===R?cc(cj,ck):cj;},cf.Els,ce);}else{ch=cd.$1;ci=cd.$0;cd=ci;ce=cc(ch,ce);}}}b$=b_.El;bX.Iter((ca=b_.El,function(cd){be.RemoveNode(ca,cd);}),bX.Except(bX.DocChildren(b_),bX.Children(b_.El,b6.GetOptional(b_.Delimiters))));cc(b_.Children,(cb=b6.GetOptional(b_.Delimiters),cb!=null&&cb.$==1?cb.$0[1]:null));};_7.$cctor=function(){_7.$cctor=a.ignore;_7.counter=0;};_8=f.DocElemNode=b6.Class({Equals:function(b_){return this.ElKey===b_.ElKey;},GetHashCode:function(){return this.ElKey;}},null,_8);_8.New=function(b_,b$,ca,cb,cc,cd){var ce;return new _8((ce={Attr:b_,Children:b$,El:cb,ElKey:cc},(b6.SetOptional(ce,"Delimiters",ca),b6.SetOptional(ce,"Render",cd),ce)));};_.InMemory=function(b_){return new bm.New(b_);};ba=f.Elt=b6.Class({},J,ba);ba.TreeNode=function(b_,b$){var ca,cb;function cc(cd,ce){return bn.Updates(ce);}ca=bx.Create(b$);return new ba.New$1({$:6,$0:b_},Q.Map2Unit((cb=m.map(function(cd){return cc(cd[0],cd[1]);},b_.Attrs),bl.TreeReduce(Q.Const(),Q.Map2Unit,cb)),ca.v),m.get(b_.Els,0),ca);};ba.New$1=b6.Ctor(function(b_,b$,ca,cb){J.New.call(this,b_,b$);this.docNode$1=b_;this.updates$1=b$;this.elt=ca;this.rvUpdates=cb;},ba);bc.convertTextNode=function(b_){var b$,ca,cb,cc,cd,ce;b$=null;ca=0;cc=b_.textContent;cd=new a.RegExp(I.TextHoleRE(),"g");while(b$=cd.exec(cc),b$!==null){b_.parentNode.insertBefore(self.document.createTextNode(bd.string(cc,{$:1,$0:ca},{$:1,$0:cd.lastIndex-m.get(b$,0).length-1})),b_);ca=cd.lastIndex;ce=self.document.createElement("span");ce.setAttribute("ws-replace",m.get(b$,1).toLowerCase());b_.parentNode.insertBefore(ce,b_);}cd.lastIndex=0;b_.textContent=bd.string(cc,{$:1,$0:ca},null);};bc.failNotLoaded=function(b_){b7.warn("Instantiating non-loaded template",b_);};bc.fillTextHole=function(b_,b$,ca){var cb;cb=b_.querySelector("[ws-replace]");return q.Equals(cb,null)?(b7.warn("Filling non-existent text hole",ca),null):(cb.parentNode.replaceChild(self.document.createTextNode(b$),cb),{$:1,$0:cb.getAttribute("ws-replace")});};bc.removeHolesExcept=function(b_,b$){function ca(cb){I.foreachNotPreserved(b_,"["+cb+"]",function(cc){if(!b$.Contains(cc.getAttribute(cb)))cc.removeAttribute(cb);});}ca("ws-attr");ca("ws-onafterrender");ca("ws-var");I.foreachNotPreserved(b_,"[ws-hole]",function(cb){if(!b$.Contains(cb.getAttribute("ws-hole"))){cb.removeAttribute("ws-hole");while(cb.hasChildNodes())cb.removeChild(cb.lastChild);}});I.foreachNotPreserved(b_,"[ws-replace]",function(cb){if(!b$.Contains(cb.getAttribute("ws-replace")))cb.parentNode.removeChild(cb);});I.foreachNotPreserved(b_,"[ws-on]",function(cb){cb.setAttribute("ws-on",bw.concat(" ",m.filter(function(cc){return b$.Contains(m.get(bw.SplitChars(cc,[":"],1),1));},bw.SplitChars(cb.getAttribute("ws-on"),[" "],1))));});I.foreachNotPreserved(b_,"[ws-attr-holes]",function(cb){var cc,cd,ce,cf,cg;cc=bw.SplitChars(cb.getAttribute("ws-attr-holes"),[" "],1);for(cd=0,ce=cc.length-1;cd<=ce;cd++){cf=m.get(cc,cd);cb.setAttribute(cf,(cg=new a.RegExp(I.TextHoleRE(),"g"),cb.getAttribute(cf).replace(cg,function(ch,ci){return b$.Contains(ci)?ch:"";})));}});};bc.fillInstanceAttrs=function(b_,b$){var ca,cb,cc,cd,ce;bc.convertAttrs(b$);ca=b$.nodeName.toLowerCase();cb=b_.querySelector("[ws-attr="+ca+"]");if(q.Equals(cb,null))b7.warn("Filling non-existent attr hole",ca);else{cb.removeAttribute("ws-attr");for(cc=0,cd=b$.attributes.length-1;cc<=cd;cc++){ce=b$.attributes.item(cc);if(ce.name=="class"&&cb.hasAttribute("class"))cb.setAttribute("class",cb.getAttribute("class")+" "+ce.nodeValue);else cb.setAttribute(ce.name,ce.nodeValue);}}};bc.mapHoles=function(b_,b$){function ca(cb){I.foreachNotPreserved(b_,"["+cb+"]",function(cc){var cd,ce;cd=(ce=null,[b$.TryGetValue(cc.getAttribute(cb).toLowerCase(),{get:function(){return ce;},set:function(cf){ce=cf;}}),ce]);if(cd[0])cc.setAttribute(cb,cd[1]);});}ca("ws-hole");ca("ws-replace");ca("ws-attr");ca("ws-onafterrender");ca("ws-var");I.foreachNotPreserved(b_,"[ws-on]",function(cb){cb.setAttribute("ws-on",bw.concat(" ",m.map(function(cc){var cd,ce,cf;cd=bw.SplitChars(cc,[":"],1);ce=(cf=null,[b$.TryGetValue(m.get(cd,1),{get:function(){return cf;},set:function(cg){cf=cg;}}),cf]);return ce[0]?m.get(cd,0)+":"+ce[1]:cc;},bw.SplitChars(cb.getAttribute("ws-on"),[" "],1))));});I.foreachNotPreserved(b_,"[ws-attr-holes]",function(cb){var cc,cd,ce;cc=bw.SplitChars(cb.getAttribute("ws-attr-holes"),[" "],1);for(cd=0,ce=cc.length-1;cd<=ce;cd++)(function(){var cf;function cg(ch,ci){var cj;cj=h.KeyValue(ci);return ch.replace(new a.RegExp("\\${"+cj[0]+"}","ig"),"${"+cj[1]+"}");}cf=m.get(cc,cd);return cb.setAttribute(cf,(((b6.Curried3(E.fold))(cg))(cb.getAttribute(cf)))(b$));}());});};bc.fill=function(b_,b$,ca){while(true)if(b_.hasChildNodes())ca=b$.insertBefore(b_.lastChild,ca);else return null;};bc.convertAttrs=function(b_){var ca,cb,cc,cd,ce,cf,cg,ch;function b$(ci){var cj;cj=b_.getAttribute(ci);if(cj==null);else b_.setAttribute(ci,cj.toLowerCase());}ca=b_.attributes;cb=[];cc=[];cd=[];for(ce=0,cf=ca.length-1;ce<=cf;ce++){cg=ca.item(ce);if(bw.StartsWith(cg.nodeName,"ws-on")&&cg.nodeName!="ws-onafterrender"&&cg.nodeName!="ws-on"){cb.push(cg.nodeName);cc.push(bd.string(cg.nodeName,{$:1,$0:"ws-on".length},null)+":"+cg.nodeValue.toLowerCase());}else!bw.StartsWith(cg.nodeName,"ws-")&&(new a.RegExp(I.TextHoleRE())).test(cg.nodeValue)?(cg.nodeValue=(ch=new a.RegExp(I.TextHoleRE(),"g"),cg.nodeValue.replace(ch,function(ci,cj){return"${"+cj.toLowerCase()+"}";})),cd.push(cg.nodeName)):void 0;}if(!(cc.length==0))b_.setAttribute("ws-on",bw.concat(" ",cc));if(!(cd.length==0))b_.setAttribute("ws-attr-holes",bw.concat(" ",cd));b$("ws-hole");b$("ws-replace");b$("ws-attr");b$("ws-onafterrender");b$("ws-var");m.iter(function(ci){b_.removeAttribute(ci);},cb);};bd.string=function(b_,b$,ca){var cb,cc;return b$==null?ca!=null&&ca.$==1?(cb=ca.$0,cb<0?"":b_.slice(0,cb+1)):"":ca==null?b_.slice(b$.$0):(cc=ca.$0,cc<0?"":b_.slice(b$.$0,cc+1));};be.ParseHTMLIntoFakeRoot=function(b_){var b$,ca,cb,cc,cd;function ce(cf,cg){var ch;while(true)if(cg===0)return cf;else{ch=cg;cf=cf.lastChild;cg=ch-1;}}b$=self.document.createElement("div");return!be.rhtml().test(b_)?(b$.appendChild(self.document.createTextNode(b_)),b$):(ca=(cb=be.rtagName().exec(b_),q.Equals(cb,null)?"":m.get(cb,1).toLowerCase()),(cc=(cd=(be.wrapMap())[ca],cd?cd:be.defaultWrap()),(b$.innerHTML=cc[1]+b_.replace(be.rxhtmlTag(),"<$1></$2>")+cc[2],ce(b$,cc[0]))));};be.ChildrenArray=function(b_){var b$,ca,cb;b$=[];for(ca=0,cb=b_.childNodes.length-1;ca<=cb;ca++)b$.push(b_.childNodes[ca]);return b$;};be.rhtml=function(){bG.$cctor();return bG.rhtml;};be.wrapMap=function(){bG.$cctor();return bG.wrapMap;};be.defaultWrap=function(){bG.$cctor();return bG.defaultWrap;};be.rxhtmlTag=function(){bG.$cctor();return bG.rxhtmlTag;};be.rtagName=function(){bG.$cctor();return bG.rtagName;};be.IterSelector=function(b_,b$,ca){var cb,cc,cd;cb=b_.querySelectorAll(b$);for(cc=0,cd=cb.length-1;cc<=cd;cc++)ca(cb[cc]);};be.IterSelectorDoc=function(b_,b$){var ca,cb,cc;ca=self.document.querySelectorAll(b_);for(cb=0,cc=ca.length-1;cb<=cc;cb++)b$(ca[cb]);};be.InsertAt=function(b_,b$,ca){var cb;if(!(ca.parentNode===b_&&b$===(cb=ca.nextSibling,q.Equals(cb,null)?null:cb)))b_.insertBefore(ca,b$);};be.RemoveNode=function(b_,b$){if(b$.parentNode===b_)b_.removeChild(b$);};E.insufficient=function(){return h.FailWith("The input sequence has an insufficient number of elements.");};E.nonNegative=function(){return h.FailWith("The input must be non-negative.");};bf=M.KeyCollection=b6.Class({GetEnumerator:function(){return _2.Get(E.map(function(b_){return b_.K;},this.d));}},e,bf);bf.New=b6.Ctor(function(b_){e.New.call(this);this.d=b_;},bf);bg.get_UseAnimations=function(){return bD.UseAnimations();};bg.Play=function(b_){var b$;b$=null;return bC.Delay(function(){return bC.Bind(bg.Run(a.ignore,bD.Actions(b_)),function(){bD.Finalize(b_);return bC.Return(null);});});};bg.Append=function(b_,b$){return{$:0,$0:bI.Append(b_.$0,b$.$0)};};bg.Run=function(b_,b$){var ca;function cb(cc){function cd(ce){return function(cf){var cg;cg=cf-ce;b$.Compute(cg);b_();return cg<=ca?void a.requestAnimationFrame(function(ch){(cd(ce))(ch);}):cc();};}a.requestAnimationFrame(function(ce){(cd(ce))(ce);});}ca=b$.Duration;return ca===0?bC.Zero():bC.FromContinuations(function(cc,cd,ce){return cb.apply(null,[cc,cd,ce]);});};bg.Concat=function(b_){return{$:0,$0:bI.Concat(E.map(bD.List,b_))};};bg.get_Empty=function(){return{$:0,$0:bI.Empty()};};bh.BatchUpdatesEnabled=function(){bE.$cctor();return bE.BatchUpdatesEnabled;};bi.StartProcessor=function(b_){var b$;function ca(){var cb;cb=null;return bC.Delay(function(){return bC.Bind(b_,function(){var cc;cc=b$[0];return q.Equals(cc,1)?(b$[0]=0,bC.Zero()):q.Equals(cc,2)?(b$[0]=1,ca()):bC.Zero();});});}b$=[0];return function(){var cb;cb=b$[0];if(q.Equals(cb,0)){b$[0]=1;bC.Start(ca(),null);}else q.Equals(cb,1)?b$[0]=2:void 0;};};bk.New=function(b_,b$,ca,cb){var cc;cc={DynElem:b_,DynFlags:b$,DynNodes:ca};b6.SetOptional(cc,"OnAfterRender",cb);return cc;};bl.mapInPlace=function(b_,b$){var ca,cb;for(ca=0,cb=b$.length-1;ca<=cb;ca++)b$[ca]=b_(b$[ca]);return b$;};bl.ofSeqNonCopying=function(b_){var b$,ca;if(b_ instanceof a.Array)return b_;else if(b_ instanceof bv)return m.ofList(b_);else if(b_===null)return[];else{b$=[];ca=_2.Get(b_);try{while(ca.MoveNext())b$.push(ca.Current());return b$;}finally{if(typeof ca=="object"&&"Dispose"in ca)ca.Dispose();}}};bl.TreeReduce=function(b_,b$,ca){var cb;function cc(cd){return function(ce){var cf,cg;switch(ce<=0?0:ce===1?cd>=0&&cd<cb?1:(cf=ce,2):(cf=ce,2)){case 0:return b_;case 1:return m.get(ca,cd);case 2:cg=ce/2>>0;return b$((cc(cd))(cg),(cc(cd+cg))(ce-cg));}};}cb=m.length(ca);return(cc(0))(cb);};bl.MapTreeReduce=function(b_,b$,ca,cb){var cc;function cd(ce){return function(cf){var cg,ch;switch(cf<=0?0:cf===1?ce>=0&&ce<cc?1:(cg=cf,2):(cg=cf,2)){case 0:return b$;case 1:return b_(m.get(cb,ce));case 2:ch=cf/2>>0;return ca((cd(ce))(ch),(cd(ce+ch))(cf-ch));}};}cc=m.length(cb);return(cd(0))(cc);};bm=_.ArrayStorage=b6.Class({SSet:function(b_){return m.ofSeq(b_);},SSetAt:function(b_,b$,ca){m.set(ca,b_,b$);return ca;},SAppend:function(b_,b$){b$.push(b_);return b$;},SInit:function(){return this.init;}},e,bm);bm.New=b6.Ctor(function(b_){e.New.call(this);this.init=b_;},bm);bn.Insert=function(b_,b$){var ca,cb,cc;function cd(ce){var cf,cg;while(true)if(!(ce===null)){if(ce!=null&&ce.$==1)return ca.push(ce.$0);else if(ce!=null&&ce.$==2){cf=ce.$1;cg=ce.$0;cd(cg);ce=cf;}else return ce!=null&&ce.$==3?ce.$0(b_):ce!=null&&ce.$==4?cb.push(ce.$0):null;}else return null;}ca=[];cb=[];cd(b$);cc=ca.slice(0);return bk.New(b_,bn.Flags(b$),cc,cb.length===0?null:{$:1,$0:function(ce){E.iter(function(cf){cf(ce);},cb);}});};bn.Updates=function(b_){return bl.MapTreeReduce(function(b$){return b$.NChanged();},Q.Const(),Q.Map2Unit,b_.DynNodes);};bn.Empty=function(b_){return bk.New(b_,0,[],null);};bn.Flags=function(b_){return b_!==null&&b_.hasOwnProperty("flags")?b_.flags:0;};bn.Static=function(b_){return new br({$:3,$0:b_});};bn.Dynamic=function(b_,b$){return new br({$:1,$0:new bJ.New(b_,b$)});};bn.EmptyAttr=function(){bM.$cctor();return bM.EmptyAttr;};bn.HasExitAnim=function(b_){var b$;b$=2;return(b_.DynFlags&b$)===b$;};bn.GetExitAnim=function(b_){return bn.GetAnim(b_,function(b$,ca){return b$.NGetExitAnim(ca);});};bn.HasEnterAnim=function(b_){var b$;b$=1;return(b_.DynFlags&b$)===b$;};bn.GetEnterAnim=function(b_){return bn.GetAnim(b_,function(b$,ca){return b$.NGetEnterAnim(ca);});};bn.HasChangeAnim=function(b_){var b$;b$=4;return(b_.DynFlags&b$)===b$;};bn.GetChangeAnim=function(b_){return bn.GetAnim(b_,function(b$,ca){return b$.NGetChangeAnim(ca);});};bn.AppendTree=function(b_,b$){var ca;return b_===null?b$:b$===null?b_:(ca=new br({$:2,$0:b_,$1:b$}),(bn.SetFlags(ca,bn.Flags(b_)|bn.Flags(b$)),ca));};bn.GetAnim=function(b_,b$){return bg.Concat(m.map(function(ca){return b$(ca,b_.DynElem);},b_.DynNodes));};bn.Sync=function(b_,b$){m.iter(function(ca){ca.NSync(b_);},b$.DynNodes);};bn.SetFlags=function(b_,b$){b_.flags=b$;};bo=w.Attribute=b6.Class({get_Value:function(){return this.fillWith;},get_Name:function(){return this.name;}},p,bo);bp=w.Event=b6.Class({get_Value:function(){return this.fillWith;},get_Name:function(){return this.name;}},p,bp);bq.Handler=function(b_,b$){return bn.Static(function(ca){ca.addEventListener(b_,function(cb){return(b$(ca))(cb);},false);});};bq.OnAfterRender=function(b_){return new br({$:4,$0:b_});};bq.Dynamic=function(b_,b$){return bn.Dynamic(b$,function(ca){return function(cb){return ca.setAttribute(b_,cb);};});};bq.Value=function(b_){return bq.ValueWith(bT.StringApply(),b_);};bq.FloatValueUnchecked=function(b_){return bq.ValueWith(bT.FloatApplyUnchecked(),b_);};bq.Checked=function(b_){return bq.ValueWith(bT.BoolCheckedApply(),b_);};bq.DateTimeValue=function(b_){return bq.ValueWith(bT.DateTimeApplyUnchecked(),b_);};bq.FileValue=function(b_){return bq.ValueWith(bT.FileApplyUnchecked(),b_);};bq.ValueWith=function(b_,b$){var ca;ca=b_(b$);return br.Append(bn.Static(ca[0]),bq.DynamicCustom(ca[1],ca[2]));};bq.DynamicCustom=function(b_,b$){return bn.Dynamic(b$,b_);};br=f.AttrProxy=b6.Class({},null,br);br.Handler=function(b_,b$){return br.HandlerImpl(b_,b$);};br.Concat=function(b_){var b$;b$=bl.ofSeqNonCopying(b_);return bl.TreeReduce(bn.EmptyAttr(),br.Append,b$);};br.Create=function(b_,b$){return bn.Static(function(ca){ca.setAttribute(b_,b$);});};br.HandlerImpl=function(b_,b$){return bn.Static(function(ca){ca.addEventListener(b_,function(cb){return(b$(ca))(cb);},false);});};br.Append=function(b_,b$){return bn.AppendTree(b_,b$);};bs=w.AfterRender=b6.Class({get_Value:function(){return this.fillWith;},get_Name:function(){return this.name;}},p,bs);bt=w.AfterRenderQ=b6.Class({get_Value:function(){return this.fillWith;},get_Name:function(){return this.name;}},p,bt);bv=bu.T=b6.Class({GetEnumerator:function(){return new _3.New(this,null,function(b_){var b$;b$=b_.s;return b$.$==0?false:(b_.c=b$.$0,b_.s=b$.$1,true);},void 0);}},null,bv);bv.Empty=new bv({$:0});bw.concat=function(b_,b$){return m.ofSeq(b$).join(b_);};bw.SplitChars=function(b_,b$,ca){return bw.Split(b_,new a.RegExp("["+bw.RegexEscape(b$.join(""))+"]"),ca);};bw.StartsWith=function(b_,b$){return b_.substring(0,b$.length)==b$;};bw.Split=function(b_,b$,ca){return ca===1?m.filter(function(cb){return cb!=="";},bw.SplitWith(b_,b$)):bw.SplitWith(b_,b$);};bw.RegexEscape=function(b_){return b_.replace(new a.RegExp("[-\\/\\\\^$*+?.()|[\\]{}]","g"),"\\$&");};bw.SplitWith=function(b_,b$){return b_.split(b$);};bw.forall=function(b_,b$){return E.forall(b_,bw.protect(b$));};bw.protect=function(b_){return b_==null?"":b_;};bx=f.Updates=b6.Class({},null,bx);bx.Create=function(b_){var b$;b$=null;b$=bx.New(b_,null,function(){var ca;ca=b$.s;return ca===null?(ca=v.Copy(b$.c()),b$.s=ca,v.WhenObsoleteRun(ca,function(){b$.s=null;}),ca):ca;});return b$;};bx.New=function(b_,b$,ca){return new bx({c:b_,s:b$,v:ca});};by=M.ValueCollection=b6.Class({GetEnumerator:function(){return _2.Get(E.map(function(b_){return b_.V;},this.d));}},e,by);by.New=b6.Ctor(function(b_){e.New.call(this);this.d=b_;},by);bA.New=function(b_,b$){return{PreviousNodes:b_,Top:b$};};bB.get_Empty=function(){return{$:0,$0:new S.New$3()};};bB.FindAll=function(b_){var b$;function ca(cd,ce){var cf,cg,ch,ci,cj;while(true)switch(cd){case 0:if(ce!=null&&ce.$==0){cg=ce.$1;ch=ce.$0;ca(0,ch);ce=cg;}else if(ce!=null&&ce.$==1){ci=ce.$0;ce=ci;cd=1;}else if(ce!=null&&ce.$==2){cj=ce.$0;ce=cj.Current;}else return ce!=null&&ce.$==6?(cf=ce.$0.Holes,(function(ck){return function(cl){m.iter(ck,cl);};}(cc))(cf)):null;break;case 1:b$.push(ce);ce=ce.Children;cd=0;break;}}function cb(cd){return ca(0,cd);}function cc(cd){return ca(1,cd);}b$=[];cb(b_);return{$:0,$0:new S.New$2(b$)};};bB.Filter=function(b_,b$){return{$:0,$0:bS.Filter(b_,b$.$0)};};bB.Except=function(b_,b$){return{$:0,$0:bS.Except(b_.$0,b$.$0)};};bB.ToArray=function(b_){return bS.ToArray(b_.$0);};bB.Intersect=function(b_,b$){return{$:0,$0:bS.Intersect(b_.$0,b$.$0)};};bC.Delay=function(b_){return function(b$){try{(b_(null))(b$);}catch(ca){b$.k({$:1,$0:ca});}};};bC.Bind=function(b_,b$){return bC.checkCancel(function(ca){b_(bP.New(function(cb){var cc;if(cb.$==0){cc=cb.$0;bC.scheduler().Fork(function(){try{(b$(cc))(ca);}catch(cd){ca.k({$:1,$0:cd});}});}else bC.scheduler().Fork(function(){ca.k(cb);});},ca.ct));});};bC.Zero=function(){bQ.$cctor();return bQ.Zero;};bC.Start=function(b_,b$){var ca,cb;ca=(cb=(bC.defCTS())[0],b$==null?cb:b$.$0);bC.scheduler().Fork(function(){if(!ca.c)b_(bP.New(function(cc){if(cc.$==1)bC.UncaughtAsyncError(cc.$0);},ca));});};bC.Return=function(b_){return function(b$){b$.k({$:0,$0:b_});};};bC.scheduler=function(){bQ.$cctor();return bQ.scheduler;};bC.checkCancel=function(b_){return function(b$){if(b$.ct.c)bC.cancel(b$);else b_(b$);};};bC.defCTS=function(){bQ.$cctor();return bQ.defCTS;};bC.UncaughtAsyncError=function(b_){b7.log("WebSharper: Uncaught asynchronous exception",b_);};bC.FromContinuations=function(b_){return function(b$){var ca;function cb(cc){if(ca[0])h.FailWith("A continuation provided by Async.FromContinuations was invoked multiple times");else{ca[0]=true;bC.scheduler().Fork(cc);}}ca=[false];b_(function(cc){cb(function(){b$.k({$:0,$0:cc});});},function(cc){cb(function(){b$.k({$:1,$0:cc});});},function(cc){cb(function(){b$.k({$:2,$0:cc});});});};};bC.cancel=function(b_){b_.k({$:2,$0:new b1.New(b_.ct)});};bD.UseAnimations=function(){bH.$cctor();return bH.UseAnimations;};bD.Actions=function(b_){return bD.ConcatActions(m.choose(function(b$){return b$.$==1?{$:1,$0:b$.$0}:null;},bI.ToArray(b_.$0)));};bD.Finalize=function(b_){m.iter(function(b$){if(b$.$==0)b$.$0();},bI.ToArray(b_.$0));};bD.ConcatActions=function(b_){var b$,ca,cb,cc;b$=bl.ofSeqNonCopying(b_);ca=m.length(b$);return ca===0?bD.Const():ca===1?m.get(b$,0):(cb=E.max(E.map(function(cd){return cd.Duration;},b$)),(cc=m.map(function(cd){return bD.Prolong(cb,cd);},b$),bD.Def(cb,function(cd){m.iter(function(ce){ce.Compute(cd);},cc);})));};bD.List=function(b_){return b_.$0;};bD.Const=function(b_){return bD.Def(0,function(){return b_;});};bD.Def=function(b_,b$){return{Compute:b$,Duration:b_};};bD.Prolong=function(b_,b$){var ca,cb,cc;ca=b$.Compute;cb=b$.Duration;cc=b2.Create(function(){return b$.Compute(b$.Duration);});return{Compute:function(cd){return cd>=cb?cc.f():ca(cd);},Duration:b_};};bE.$cctor=function(){bE.$cctor=a.ignore;bE.BatchUpdatesEnabled=true;};bF.concat=function(b_){var b$,ca;b$=[];for(var cb in b_)b$.push.apply(b$,b_[cb]);return b$;};bG.$cctor=function(){var b_;bG.$cctor=a.ignore;bG.rxhtmlTag=new a.RegExp("<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\\w:]+)[^>]*)\\/>","gi");bG.rtagName=new a.RegExp("<([\\w:]+)");bG.rhtml=new a.RegExp("<|&#?\\w+;");bG.wrapMap=(b_=[1,"<table>","</table>"],{option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:b_,tbody:b_,tfoot:b_,tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><colgroup>","</colgoup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"]});bG.defaultWrap=[0,"",""];};bH.$cctor=function(){bH.$cctor=a.ignore;bH.CubicInOut=bO.Custom(function(b_){var b$;b$=b_*b_;return 3*b$-2*(b$*b_);});bH.UseAnimations=true;};bI.Append=function(b_,b$){return b_.$==0?b$:b$.$==0?b_:{$:2,$0:b_,$1:b$};};bI.ToArray=function(b_){var b$;function ca(cb){var cc,cd;while(true)if(cb.$==1)return b$.push(cb.$0);else if(cb.$==2){cc=cb.$1;cd=cb.$0;ca(cd);cb=cc;}else return cb.$==3?m.iter(function(ce){b$.push(ce);},cb.$0):null;}b$=[];ca(b_);return b$.slice(0);};bI.Concat=function(b_){var b$;b$=bl.ofSeqNonCopying(b_);return bl.TreeReduce(bI.Empty(),bI.Append,b$);};bI.Empty=function(){b3.$cctor();return b3.Empty;};bu.head=function(b_){return b_.$==1?b_.$0:bu.listEmpty();};bu.tail=function(b_){return b_.$==1?b_.$1:bu.listEmpty();};bu.listEmpty=function(){return h.FailWith("The input list was empty.");};bJ=f.DynamicAttrNode=b6.Class({NChanged:function(){return this.updates;},NGetExitAnim:function(b_){return bg.get_Empty();},NGetEnterAnim:function(b_){return bg.get_Empty();},NGetChangeAnim:function(b_){return bg.get_Empty();},NSync:function(b_){if(this.dirty){(this.push(b_))(this.value);this.dirty=false;}}},e,bJ);bJ.New=b6.Ctor(function(b_,b$){var ca;ca=this;e.New.call(this);this.push=b$;this.value=void 0;this.dirty=false;this.updates=Q.Map(function(cb){ca.value=cb;ca.dirty=true;},b_);},bJ);bL=d.KeyNotFoundException=b6.Class({},bK,bL);bL.New=b6.Ctor(function(){bL.New$1.call(this,"The given key was not present in the dictionary.");},bL);bL.New$1=b6.Ctor(function(b_){this.message=b_;R.setPrototypeOf(this,bL.prototype);},bL);bM.$cctor=function(){var b_,b$,ca,cb,cc,cd,ce,cf,cg,ch,ci,cj,ck,cl;bM.$cctor=a.ignore;bM.EmptyAttr=null;bM.BoolCheckedApply=function(cm){function cn(co,cp){return cp!=null&&cp.$==1?void(co.checked=cp.$0):null;}return[function(co){co.addEventListener("change",function(){return cm.Get()!=co.checked?cm.Set(co.checked):null;});},function(co){return function(cp){return cn(co,cp);};},Q.Map(function(co){return{$:1,$0:co};},cm.get_View())];};bM.StringSet=function(cm){return function(cn){cm.value=cn;};};bM.StringGet=function(cm){return{$:1,$0:cm.value};};bM.StringApply=(b_=bT.StringGet(),(b$=bT.StringSet(),function(cm){return bT.ApplyValue(b_,b$,cm);}));bM.DateTimeSetUnchecked=function(cm){return function(cn){cm.value=(new a.Date(cn)).toLocaleString();};};bM.DateTimeGetUnchecked=function(cm){var cn,co,cp,cq;cn=cm.value;return bU.isBlank(cn)?{$:1,$0:-8640000000000000}:(co=(cp=0,[(cq=b0.TryParse(cn),cq!=null&&cq.$==1&&(cp=cq.$0,true)),cp]),co[0]?{$:1,$0:co[1]}:null);};bM.DateTimeApplyUnchecked=(ca=bT.DateTimeGetUnchecked(),(cb=bT.DateTimeSetUnchecked(),function(cm){return bT.ApplyValue(ca,cb,cm);}));bM.FileSetUnchecked=function(){return function(){return null;};};bM.FileGetUnchecked=function(cm){var cn;cn=cm.files;return{$:1,$0:m.ofSeq(E.delay(function(){return E.map(function(co){return cn.item(co);},h.range(0,cn.length-1));}))};};bM.FileApplyUnchecked=(cc=bT.FileGetUnchecked(),(cd=bT.FileSetUnchecked(),function(cm){return bT.FileApplyValue(cc,cd,cm);}));bM.IntSetUnchecked=function(cm){return function(cn){cm.value=a.String(cn);};};bM.IntGetUnchecked=function(cm){var cn,co;cn=cm.value;return bU.isBlank(cn)?{$:1,$0:0}:(co=+cn,co!==co>>0?null:{$:1,$0:co});};bM.IntApplyUnchecked=(ce=bT.IntGetUnchecked(),(cf=bT.IntSetUnchecked(),function(cm){return bT.ApplyValue(ce,cf,cm);}));bM.IntSetChecked=function(cm){return function(cn){var co;co=cn.get_Input();return cm.value!=co?void(cm.value=co):null;};};bM.IntGetChecked=function(cm){var cn,co,cp;cn=cm.value;return{$:1,$0:bU.isBlank(cn)?(cm.checkValidity?cm.checkValidity():true)?new bV({$:2,$0:cn}):new bV({$:1,$0:cn}):(co=(cp=0,[_0.TryParseInt32(cn,{get:function(){return cp;},set:function(cq){cp=cq;}}),cp]),co[0]?new bV({$:0,$0:co[1],$1:cn}):new bV({$:1,$0:cn}))};};bM.IntApplyChecked=(cg=bT.IntGetChecked(),(ch=bT.IntSetChecked(),function(cm){return bT.ApplyValue(cg,ch,cm);}));bM.FloatSetUnchecked=function(cm){return function(cn){cm.value=a.String(cn);};};bM.FloatGetUnchecked=function(cm){var cn,co;cn=cm.value;return bU.isBlank(cn)?{$:1,$0:0}:(co=+cn,a.isNaN(co)?null:{$:1,$0:co});};bM.FloatApplyUnchecked=(ci=bT.FloatGetUnchecked(),(cj=bT.FloatSetUnchecked(),function(cm){return bT.ApplyValue(ci,cj,cm);}));bM.FloatSetChecked=function(cm){return function(cn){var co;co=cn.get_Input();return cm.value!=co?void(cm.value=co):null;};};bM.FloatGetChecked=function(cm){var cn,co;cn=cm.value;return{$:1,$0:bU.isBlank(cn)?(cm.checkValidity?cm.checkValidity():true)?new bV({$:2,$0:cn}):new bV({$:1,$0:cn}):(co=+cn,a.isNaN(co)?new bV({$:1,$0:cn}):new bV({$:0,$0:co,$1:cn}))};};bM.FloatApplyChecked=(ck=bT.FloatGetChecked(),(cl=bT.FloatSetChecked(),function(cm){return bT.ApplyValue(ck,cl,cm);}));};bN=bC.Scheduler=b6.Class({Fork:function(b_){var b$;b$=this;this.robin.push(b_);if(this.idle){this.idle=false;a.setTimeout(function(){b$.tick();},0);}},tick:function(){var b_,b$,ca;b$=this;ca=b9.now();b_=true;while(b_)if(this.robin.length===0){this.idle=true;b_=false;}else{(this.robin.shift())();b9.now()-ca>40?(a.setTimeout(function(){b$.tick();},0),b_=false):void 0;}}},e,bN);bN.New=b6.Ctor(function(){e.New.call(this);this.idle=true;this.robin=[];},bN);bO=f.Easing=b6.Class({},e,bO);bO.Custom=function(b_){return new bO.New(b_);};bO.New=b6.Ctor(function(b_){e.New.call(this);this.transformTime=b_;},bO);bP.New=function(b_,b$){return{k:b_,ct:b$};};bQ.$cctor=function(){bQ.$cctor=a.ignore;bQ.noneCT=bR.New(false,[]);bQ.scheduler=new bN.New();bQ.defCTS=[new bW.New()];bQ.Zero=bC.Return();bQ.GetCT=function(b_){b_.k({$:0,$0:b_.ct});};};bR.New=function(b_,b$){return{c:b_,r:b$};};bS.Filter=function(b_,b$){return new S.New$2(m.filter(b_,bS.ToArray(b$)));};bS.Except=function(b_,b$){var ca;ca=new S.New$2(bS.ToArray(b$));ca.ExceptWith(bS.ToArray(b_));return ca;};bS.ToArray=function(b_){var b$;b$=m.create(b_.Count(),void 0);b_.CopyTo(b$,0);return b$;};bS.Intersect=function(b_,b$){var ca;ca=new S.New$2(bS.ToArray(b_));ca.IntersectWith(bS.ToArray(b$));return ca;};bT.ApplyValue=function(b_,b$,ca){var cb;function cc(cd,ce){return ce==null?null:cd(ce.$0);}cb=null;return[function(cd){function ce(){ca.UpdateMaybe(function(cf){var cg;cb=b_(cd);return cb!=null&&cb.$==1&&(!q.Equals(cb.$0,cf)&&(cg=[cb,cb.$0],true))?cg[0]:null;});}cd.addEventListener("change",ce);cd.addEventListener("input",ce);cd.addEventListener("keypress",ce);},function(cd){var ce;ce=b$(cd);return function(cf){return cc(ce,cf);};},Q.Map(function(cd){var ce;return cb!=null&&cb.$==1&&(q.Equals(cb.$0,cd)&&(ce=cb.$0,true))?null:{$:1,$0:cd};},ca.get_View())];};bT.StringSet=function(){bM.$cctor();return bM.StringSet;};bT.StringGet=function(){bM.$cctor();return bM.StringGet;};bT.DateTimeSetUnchecked=function(){bM.$cctor();return bM.DateTimeSetUnchecked;};bT.DateTimeGetUnchecked=function(){bM.$cctor();return bM.DateTimeGetUnchecked;};bT.FileApplyValue=function(b_,b$,ca){var cb;function cc(cd,ce){return ce==null?null:cd(ce.$0);}cb=null;return[function(cd){cd.addEventListener("change",function(){ca.UpdateMaybe(function(ce){var cf;cb=b_(cd);return cb!=null&&cb.$==1&&(cb.$0!==ce&&(cf=[cb,cb.$0],true))?cf[0]:null;});});},function(cd){var ce;ce=b$(cd);return function(cf){return cc(ce,cf);};},Q.Map(function(cd){var ce;return cb!=null&&cb.$==1&&(q.Equals(cb.$0,cd)&&(ce=cb.$0,true))?null:{$:1,$0:cd};},ca.get_View())];};bT.FileSetUnchecked=function(){bM.$cctor();return bM.FileSetUnchecked;};bT.FileGetUnchecked=function(){bM.$cctor();return bM.FileGetUnchecked;};bT.IntSetUnchecked=function(){bM.$cctor();return bM.IntSetUnchecked;};bT.IntGetUnchecked=function(){bM.$cctor();return bM.IntGetUnchecked;};bT.IntSetChecked=function(){bM.$cctor();return bM.IntSetChecked;};bT.IntGetChecked=function(){bM.$cctor();return bM.IntGetChecked;};bT.FloatSetUnchecked=function(){bM.$cctor();return bM.FloatSetUnchecked;};bT.FloatGetUnchecked=function(){bM.$cctor();return bM.FloatGetUnchecked;};bT.FloatSetChecked=function(){bM.$cctor();return bM.FloatSetChecked;};bT.FloatGetChecked=function(){bM.$cctor();return bM.FloatGetChecked;};bT.StringApply=function(){bM.$cctor();return bM.StringApply;};bT.FloatApplyUnchecked=function(){bM.$cctor();return bM.FloatApplyUnchecked;};bT.BoolCheckedApply=function(){bM.$cctor();return bM.BoolCheckedApply;};bT.DateTimeApplyUnchecked=function(){bM.$cctor();return bM.DateTimeApplyUnchecked;};bT.FileApplyUnchecked=function(){bM.$cctor();return bM.FileApplyUnchecked;};bU.isBlank=function(b_){return bw.forall(bZ.IsWhiteSpace,b_);};bV=f.CheckedInput=b6.Class({get_Input:function(){return this.$==1?this.$0:this.$==2?this.$0:this.$1;}},null,bV);bW=d.CancellationTokenSource=b6.Class({},e,bW);bW.New=b6.Ctor(function(){e.New.call(this);this.c=false;this.pending=null;this.r=[];this.init=1;},bW);bX.Children=function(b_,b$){var ca,cb,cc;if(b$!=null&&b$.$==1){cc=[];ca=b$.$0[0].nextSibling;while(ca!==b$.$0[1]){cc.push(ca);ca=ca.nextSibling;}return{$:0,$0:cc};}else return{$:0,$0:m.init(b_.childNodes.length,(cb=b_.childNodes,function(cd){return cb[cd];}))};};bX.Except=function(b_,b$){var ca;ca=b_.$0;return{$:0,$0:m.filter(function(cb){return m.forall(function(cc){return!(cb===cc);},ca);},b$.$0)};};bX.Iter=function(b_,b$){m.iter(b_,b$.$0);};bX.DocChildren=function(b_){var b$;function ca(cb){var cc,cd,ce,cf;while(true){if(cb!=null&&cb.$==2){cd=cb.$0;cb=cd.Current;}else if(cb!=null&&cb.$==1)return b$.push(cb.$0.El);else if(cb==null)return null;else if(cb!=null&&cb.$==5)return b$.push(cb.$0);else if(cb!=null&&cb.$==4)return b$.push(cb.$0.Text);else if(cb!=null&&cb.$==6){cc=cb.$0.Els;return(function(cg){return function(ch){m.iter(cg,ch);};}(function(cg){if(cg==null||cg.constructor===R)ca(cg);else b$.push(cg);}))(cc);}else{ce=cb.$1;cf=cb.$0;ca(cf);cb=ce;}}}b$=[];ca(b_.Children);return{$:0,$0:bl.ofSeqNonCopying(b$)};};bY.Clear=function(b_){b_.splice(0,m.length(b_));};bZ.IsWhiteSpace=function(b_){return b_.match(new a.RegExp("\\s"))!==null;};b0.TryParse=function(b_){var b$;b$=b9.parse(b_);return a.isNaN(b$)?null:{$:1,$0:b$};};_0.TryParse=function(b_,b$,ca,cb){var cc,cd;cc=+b_;cd=cc===cc-cc%1&&cc>=b$&&cc<=ca;if(cd)cb.set(cc);return cd;};b1=d.OperationCanceledException=b6.Class({},bK,b1);b1.New=b6.Ctor(function(b_){b1.New$1.call(this,"The operation was canceled.",null,b_);},b1);b1.New$1=b6.Ctor(function(b_,b$,ca){this.message=b_;this.inner=b$;R.setPrototypeOf(this,b1.prototype);this.ct=ca;},b1);b2.Create=function(b_){return b5.New(false,b_,b2.forceLazy);};b2.forceLazy=function(){var b_;b_=this.v();this.c=true;this.v=b_;this.f=b2.cachedLazy;return b_;};b2.cachedLazy=function(){return this.v;};b3.$cctor=function(){b3.$cctor=a.ignore;b3.Empty={$:0};};b5.New=function(b_,b$,ca){return{c:b_,v:b$,f:ca};};b6.OnLoad(function(){c.Main();});}(self));


if (typeof WebSharper !=='undefined') {
  WebSharper.Runtime.ScriptBasePath = '/Content/';
  WebSharper.Runtime.Start();
}
